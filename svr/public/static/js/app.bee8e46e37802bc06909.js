webpackJsonp([2,0],{0:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var a=n(10),o=i(a),r=n(423),s=(i(r),n(429)),l=i(s),c=n(47),u=i(c);n(7),n(15),o.default.config.ignoredElements=["game","help","gestures","design","product","chat","noty","goods","buy","profile","order"],n(296),n(420);var d={install:function(e,t){e.myGlobalMethod=function(){return console.log(t),"aaaa"},e.prototype.$myMethod=function(e){return console.log(e,t),"bbbb"},e.prototype.$isDev=t.dev}};window.target_player=null,o.default.use(d,{dev:!1}),window.vm=new o.default({el:"#app",template:"<App/>",components:{App:l.default}}),u.default.init()},7:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(249),o=i(a),r=new LokiIndexedAdapter,s=void 0;t.default=new o.default(function(e,t){if(s)e(s);else var n=new loki("bazaar.db",{adapter:r,autoload:!0,autoloadCallback:function(){s={products:n.getCollection("product")?n.getCollection("product"):n.addCollection("product"),chat_log:n.getCollection("chat_log")?n.getCollection("chat_log"):n.addCollection("chat_log"),gestures:n.getCollection("gestures")?n.getCollection("gestures"):n.addCollection("gestures"),notification:n.getCollection("notification")?n.getCollection("notification"):n.addCollection("notification")},e(s)},autosave:!0,autosaveInterval:1e3})})},15:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(31),o=i(a),r=n(32),s=i(r),l=n(101),c=i(l),u=n(400),d=i(u),h=n(47),f=i(h),p=n(7),v=i(p),g=n(1),m=window.location.href;"/"!=m.substr(m.lenght-1,1)&&(m=m.substr(0,m.lastIndexOf("/")));var y=function(){function t(){(0,o.default)(this,t),"undefined"!=typeof io&&(this.sock=io(m),this.sock.on("connect",this.on_connect.bind(this)),this.sock.on("new_player_online",this.on_new_player_online.bind(this)),this.sock.on("player_offline",this.on_player_offline.bind(this)),this.sock.on("player_move",this.on_player_move.bind(this)),this.sock.on("stop_move",this.on_stop_move.bind(this)),this.sock.on("speak_to_all",this.on_recieve_chat.bind(this)),this.sock.on("speak_to_target",this.on_recieve_chat.bind(this)),this.sock.on("notify_seller_status",this.on_notify_seller_status.bind(this)),this.sock.on("get_target_goods",this.on_get_target_goods.bind(this)),this.sock.on("system_notification",this.on_system_notification.bind(this)))}return(0,s.default)(t,[{key:"register_ui_evt",value:function(){var e=this;vm.$on("notify_seller_status",function(t){e.emit("notify_seller_status",t)})}},{key:"on_system_notification",value:function(e){v.default.then(function(t){t.notification.insert({dt:g().format("YYYY-MM-DD HH:mm:ss"),content:e}),phonon.notif(e,3e3),vm.$emit("refresh_sys_noty",""),vm.$emit("refresh_order_status","")})}},{key:"on_notify_seller_status",value:function(e){var t=f.default.get_player_by_id(e.openid);t&&t.show_sign(e.seller)}},{key:"on_get_target_goods",value:function(e,t){v.default.then(function(e){var n=e.products.find({});t(n)})}},{key:"on_connect",value:function(){}},{key:"get_orders",value:function(e,t){this.emit("get_orders",e,function(e){t(e)})}},{key:"post_online",value:function(t){var n=this;v.default.then(function(i){var a=i.products.findOne({}),o=e.extend(wi,t.get_loc());a&&(o.seller=!0),n.emit("player_online",o,function(e){console.log("当前在线："+e.length+"人"),window.vm.$emit("count_changed",e.length);var t=(0,d.default)(e,f.default.player_infos(),"openid");(0,c.default)(t,function(e){return f.default.new_player(e)})}),n.register_ui_evt()})}},{key:"on_recieve_chat",value:function(e){phonon.notif(e.from+"说:"+e.content,3e3),v.default.then(function(t){t.chat_log.insert(e),vm.$emit("refresh_chat_log","")})}},{key:"emit",value:function(e,t,n){this.sock&&this.sock.emit(e,t,n)}},{key:"on_new_player_online",value:function(e){f.default.new_player(e),window.vm.$emit("count_changed",f.default.players.length)}},{key:"on_player_offline",value:function(e){f.default.remove_player(e.openid),window.vm.$emit("count_changed",f.default.players.length)}},{key:"on_player_move",value:function(e){console.log("on_player_move p",e);var t=f.default.get_player_by_id(e.openid);console.log("on_player_move t",t),t&&(t.translate(e.x,e.y),t.move(e.dx,e.dy))}},{key:"on_stop_move",value:function(e){var t=f.default.get_player_by_id(e.openid);t&&(t.translate(e.x,e.y),t.stop_move())}}]),t}();t.default=new y}).call(t,n(8))},47:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(31),o=i(a),r=n(32),s=i(r),l=n(401),c=i(l),u=n(402),d=i(u),h=n(409),f=i(h),p=n(101),v=i(p);n(244);var g=n(242),m=i(g),y=n(15),_=i(y),w=void 0,x=function(){function e(){(0,o.default)(this,e),this.players=[],w=ga(512,512,this.setup.bind(this),["res/imgs.json","res/walkcycle.png"]),w.fps=30}return(0,s.default)(e,[{key:"init_world",value:function(){var e={clone:function(){return w.sprite("gnd.png")}};this.world=w.staticGroup();var t=65536;this.world.world_center=t/2,this.world.width=t,this.world.height=t,this.world.loaded_world_map={},this.world.candidate=[],this.world.candidate.push(e)}},{key:"setup",value:function(){var e=this;this.init_world(),this.canvas=w.canvas,this.mplayer=this.new_player(wi,!0);var t=function(){e.mplayer.camera.width=w.canvas.width=window.innerWidth,e.mplayer.camera.height=w.canvas.height=window.innerHeight};t(),window.onresize=t,w.state=this.play.bind(this),_.default.post_online(this.mplayer)}},{key:"play",value:function(){(0,v.default)(this.players,function(e){return e.update()})}},{key:"player_infos",value:function(){return(0,f.default)(this.players,function(e){return e.wi})}},{key:"get_player_by_id",value:function(e){return(0,d.default)(this.players,function(t){return t.wi.openid==e})}},{key:"test_hit",value:function(e,t){var n=(0,d.default)(this.players,function(n){return n.test_hit(e,t)});return n&&n.on_hit(),n}},{key:"new_player",value:function(e,t){var n=new m.default(w,this.world,e,t);return this.players.push(n),n}},{key:"remove_player",value:function(e){this.players=(0,c.default)(this.players,function(t){return t.wi.openid!=e||(t.vanish(),!1)})}},{key:"init",value:function(){w.start()}}]),e}();t.default=new x},48:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){this.X=e,this.Y=t}function o(e,t,n,i){this.X=e,this.Y=t,this.Width=n,this.Height=i}function r(e,t,n){this.Name=e,this.Comments=n||"",this.Points=c(t,P),this.points=k(this.Points);var i=u(this.Points);this.Points=d(this.Points,-i),this.Points=h(this.Points,T),this.Points=f(this.Points,O),this.Vector=p(this.Points)}function s(e,t){this.Name=e,this.Score=t}function l(){this.Unistrokes=[],this.Recognize=function(e,t){e=c(e,P);var n=u(e);e=d(e,-n),e=h(e,T),e=f(e,O);for(var i=p(e),a=+(1/0),o=-1,r=0;r<this.Unistrokes.length;r++){var l;l=t?v(this.Unistrokes[r].Vector,i):g(e,this.Unistrokes[r],-A,+A,E),l<a&&(a=l,o=r)}return o==-1?new s("No match.",0):new s(this.Unistrokes[o].Name,t?1/a:1-a/X)},this.IsEmpty=function(){return 0==this.Unistrokes.length},this.Clear=function(){this.Unistrokes.length=0},this.DeleteByName=function(e){this.Unistrokes=this.Unistrokes.filter(function(t){return t.Name!=e})},this.StringifyGestures=function(){for(var e=[],t=0;t<this.Unistrokes.length;t++)e.push({name:this.Unistrokes[t].Name,points:this.Unistrokes[t].points,comments:this.Unistrokes[t].Comments});return(0,M.default)(e)},this.ParseInGestures=function(e){try{for(var t=JSON.parse(e),n=0;n<t.length;n++)this.Unistrokes.push(new r(t[n].name,t[n].points,t[n].comments))}catch(e){console.log("ParseInGestures failed",e)}},this.GetUnistroke=function(e){for(var t=0;t<this.Unistrokes.length;t++)if(this.Unistrokes[t].Name==e)return this.Unistrokes[t]},this.GetUnistrokes=function(){return this.Unistrokes},this.UpdateGesture=function(e,t,n){for(var i=0;i<this.Unistrokes.length;i++)if(this.Unistrokes[i].Name==e)return this.Unistrokes[i]=new r(e,t,n),"updated";if(i==this.Unistrokes.length)return this.Unistrokes[this.Unistrokes.length]=new r(e,t,n),"added"},this.AddGesture=function(e,t){this.Unistrokes[this.Unistrokes.length]=new r(e,t);for(var n=0,i=0;i<this.Unistrokes.length;i++)this.Unistrokes[i].Name==e&&n++;return n},this.DeleteUserGestures=function(){return this.Unistrokes.length=S,S},this.GetGesturePoints=function(e,t,n){var i=[];return this.Unistrokes.forEach(function(t){t.Name==e&&(i=t.points)}),t&&(i=h(i,t)),n&&(i=f(i,n)),i}}function c(e,t){for(var n=x(e)/(t-1),i=0,o=new Array(e[0]),r=1;r<e.length;r++){var s=b(e[r-1],e[r]);if(i+s>=n){var l=e[r-1].X+(n-i)/s*(e[r].X-e[r-1].X),c=e[r-1].Y+(n-i)/s*(e[r].Y-e[r-1].Y),u=new a(l,c);o[o.length]=u,e.splice(r,0,u),i=0}else i+=s}return o.length==t-1&&(o[o.length]=new a(e[e.length-1].X,e[e.length-1].Y)),o}function u(e){var t=y(e);return Math.atan2(t.Y-e[0].Y,t.X-e[0].X)}function d(e,t){for(var n=y(e),i=Math.cos(t),o=Math.sin(t),r=new Array,s=0;s<e.length;s++){var l=(e[s].X-n.X)*i-(e[s].Y-n.Y)*o+n.X,c=(e[s].X-n.X)*o+(e[s].Y-n.Y)*i+n.Y;r[r.length]=new a(l,c)}return r}function h(e,t){for(var n=_(e),i=new Array,o=0;o<e.length;o++){var r=e[o].X*(t/n.Width),s=e[o].Y*(t/n.Height);i[i.length]=new a(r,s)}return i}function f(e,t){for(var n=y(e),i=new Array,o=0;o<e.length;o++){var r=e[o].X+t.X-n.X,s=e[o].Y+t.Y-n.Y;i[i.length]=new a(r,s)}return i}function p(e){for(var t=0,n=new Array,i=0;i<e.length;i++)n[n.length]=e[i].X,n[n.length]=e[i].Y,t+=e[i].X*e[i].X+e[i].Y*e[i].Y;for(var a=Math.sqrt(t),i=0;i<n.length;i++)n[i]/=a;return n}function v(e,t){for(var n=0,i=0,a=0;a<e.length;a+=2)n+=e[a]*t[a]+e[a+1]*t[a+1],i+=e[a]*t[a+1]-e[a+1]*t[a];var o=Math.atan(i/n);return Math.acos(n*Math.cos(o)+i*Math.sin(o))}function g(e,t,n,i,a){for(var o=F*n+(1-F)*i,r=m(e,t,o),s=(1-F)*n+F*i,l=m(e,t,s);Math.abs(i-n)>a;)r<l?(i=s,s=o,l=r,o=F*n+(1-F)*i,r=m(e,t,o)):(n=o,o=s,r=l,s=(1-F)*n+F*i,l=m(e,t,s));return Math.min(r,l)}function m(e,t,n){var i=d(e,n);return w(i,t.Points)}function y(e){for(var t=0,n=0,i=0;i<e.length;i++)t+=e[i].X,n+=e[i].Y;return t/=e.length,n/=e.length,new a(t,n)}function _(e){for(var t=+(1/0),n=-(1/0),i=+(1/0),a=-(1/0),r=0;r<e.length;r++)t=Math.min(t,e[r].X),i=Math.min(i,e[r].Y),n=Math.max(n,e[r].X),a=Math.max(a,e[r].Y);return new o(t,i,n-t,a-i)}function w(e,t){for(var n=0,i=0;i<e.length;i++)n+=b(e[i],t[i]);return n/e.length}function x(e){for(var t=0,n=1;n<e.length;n++)t+=b(e[n-1],e[n]);return t}function b(e,t){var n=t.X-e.X,i=t.Y-e.Y;return Math.sqrt(n*n+i*i)}function C(e){return e*Math.PI/180}function k(e){return JSON.parse((0,M.default)(e))}Object.defineProperty(t,"__esModule",{value:!0});var j=n(49),M=i(j),S=16,P=64,T=250,O=new a(0,0),Y=Math.sqrt(T*T+T*T),X=.5*Y,A=C(45),E=C(2),F=.5*(-1+Math.sqrt(5)),N=new l;t.default=N},67:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){this.X=e,this.Y=t}function o(){f.default.then(function(t){var n=t.gestures.findOne({});n?(d.default.ParseInGestures(n.gestures),console.log("load gestures from db; length="+d.default.Unistrokes.length)):e.get("/static/default_gestures.txt",function(e,n){"success"==n?(d.default.ParseInGestures(e),t.gestures.insert({gestures:e}),console.log("load gestures from ajax")):alert("获取默认手势失败:"+n)})})}Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),s=i(r),l=n(32),c=i(l),u=n(48),d=i(u),h=n(7),f=i(h);o();var p=function(){function t(e,n){(0,s.default)(this,t),this.points=[],this.dealer=n,this.canvas=e,this.context=e.getContext("2d"),this.isDrawing=!1,this.init()}return(0,c.default)(t,[{key:"clear",value:function(){this.points.length=0,this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"touchstart",value:function(e){this.context.beginPath(),this.context.moveTo(e.x,e.y),this.isDrawing=!0,this.points.push(new a(e.x,e.y)),this.dealer&&this.dealer.touchstart&&this.dealer.touchstart(this)}},{key:"touchmove",value:function(e){this.isDrawing&&(this.context.lineTo(e.x,e.y),this.context.stroke(),this.points.push(new a(e.x,e.y)))}},{key:"touchend",value:function(e){if(this.isDrawing){if(this.touchmove(e),this.isDrawing=!1,this.points.length>=10){var t=d.default.Recognize(this.points,!1);t.Score>.85&&this.dealer&&this.dealer[t.Name]?this.dealer[t.Name](t,this.points):this.dealer&&this.dealer.no_recognize&&this.dealer.no_recognize(this.points)}else this.dealer&&this.dealer.few_touch&&this.dealer.few_touch(this.points,this.last_evt);this.dealer&&this.dealer.touchend&&this.dealer.touchend(this)}}},{key:"draw_stroke",value:function(e){this.clear(),this.context.beginPath();var t={X:this.canvas.width/2,Y:this.canvas.height/2+5},n=Math.min(this.canvas.width,this.canvas.height),i=d.default.GetGesturePoints(e,n,t);this.context.moveTo(i[0].X,i[0].Y);for(var a=1;a<i.length;++a)this.context.lineTo(i[a].X,i[a].Y),this.context.stroke();this.points=i}},{key:"draw",value:function(t){var n=null;t.offsetX,t.offsetY;switch(t.type){case"mousedown":this.last_evt=t,t.touches=[],t.touches[0]={pageX:t.pageX,pageY:t.pageY},n="touchstart";break;case"mousemove":t.touches=[],t.touches[0]={pageX:t.pageX,pageY:t.pageY},n="touchmove";break;case"mouseup":t.touches=[],t.touches[0]={pageX:t.pageX,pageY:t.pageY},n="touchend"}var i,a=e(t.target).offset();if("touchend"===t.type)i={x:t.changedTouches[0].pageX-a.left,y:t.changedTouches[0].pageY-a.top};else{this.last_evt=t;t.touches[0].target;i={x:t.touches[0].pageX-a.left,y:t.touches[0].pageY-a.top}}n=n||t.type,this[n](i)}},{key:"save",value:function(e,t){d.default.UpdateGesture(e,this.points,t);f.default.then(function(e){var t=d.default.StringifyGestures();e.gestures.remove(e.gestures.find({})),e.gestures.insert({gestures:t})})}},{key:"init",value:function(){var e="createTouch"in document||"ontouchstart"in window;e?(this.canvas.addEventListener("touchstart",this.draw.bind(this),!1),this.canvas.addEventListener("touchmove",this.draw.bind(this),!1),this.canvas.addEventListener("touchend",this.draw.bind(this),!1)):(this.canvas.addEventListener("mousedown",this.draw.bind(this),!1),this.canvas.addEventListener("mousemove",this.draw.bind(this),!1),this.canvas.addEventListener("mouseup",this.draw.bind(this),!1))}}]),t}();t.default=p}).call(t,n(8))},231:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(433),o=i(a),r=n(436),s=i(r),l=n(434),c=i(l),u=n(432),d=i(u),h=n(435),f=i(h),p=n(431),v=i(p),g=n(439),m=i(g),y=n(430),_=i(y),w=n(437),x=i(w),b=n(438),C=i(b);t.default={name:"app",data:function(){return{app:phonon.navigator()}},mounted:function(){var e=this;this.$nextTick(function(){phonon.options({navigator:{defaultPage:"game",animatePages:!0,enableBrowserBackButton:!0},i18n:null}),window.setTimeout(function(){e.app.start()},500)})},components:{Game:o.default,Help:s.default,Gestures:c.default,Design:d.default,Goods:f.default,Buy:_.default,Chat:v.default,Profile:m.default,Noty:x.default,Order:C.default}}},232:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(49),o=i(a),r=n(10),s=(i(r),n(7)),l=(i(s),n(66)),c=i(l);t.default={name:"BuyPage",props:{app:{type:Object,require:!0}},data:function(){return{goods:[],seller:{}}},mounted:function(){this.app.on({page:"buy",preventClose:!1},this)},methods:{onReady:function(){this.seller=target_player,this.goods=c.default.map(target_player.goods,function(e){return e.count=0,e})},buy:function(){var t=c.default.reduce(this.goods,function(e,t){return e.total+=parseFloat(t.count).toFixed(2)*parseFloat(t.price).toFixed(2),t.count>0&&(e.title+=" "+t.title+"("+t.count+")"),e},{total:0,title:""});return t.total<=0?phonon.alert("所选商品总价必须大于0","请选择商品数量"):(t.total*=100,t.openid=wi.openid,t.buyer_id=wi.openid,t.buyer_nickname=wi.nickname,t.seller_id=this.seller.openid,t.seller_nickname=this.seller.nickname,void e.ajax({type:"POST",url:"buy_product",contentType:"application/json; charset=utf-8",timeout:5e3,data:(0,o.default)(t),dataType:"json"}).done(function(e){return e.ret&&e.ret==-1?alert("下单失败"):void WeixinJSBridge.invoke("getBrandWCPayRequest",e,function(e){"get_brand_wcpay_request:ok"==e.err_msg?phonon.alert("付款成功，请留意系统消息","支付成功"):phonon.alert("用户取消支付","购买失败")})}).fail(function(e){alert("下单失败："+(0,o.default)(e))}))}}}}).call(t,n(8))},233:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=i(a),r=n(1),s=i(r),l=n(7),c=i(l),u=n(15),d=i(u);o.default.directive("tap",{isFn:!0,bind:function(e,t){e.on("tap",t.value)}}),t.default={name:"ChatPage",props:{app:{type:Object,require:!0}},created:function(){var e=this;this.$root.$on("refresh_chat_log",function(t){c.default.then(function(t){e.chat_log=t.chat_log.find({})})})},data:function(){return{chat_log:[],target:"所有人",content:""}},mounted:function(){this.app.on({page:"chat",preventClose:!1},this)},methods:{headimgurl:function(e){return/http/i.test(e)?e:"res/hi0.jpg"},clear:function(){var e=this;c.default.then(function(t){t.chat_log.remove(t.chat_log.find({})),e.chat_log=t.chat_log.find({})})},send:function(e){var t=this;(this.content||e)&&c.default.then(function(n){var i={from:wi.nickname,to:t.target,headimgurl:wi.headimgurl,img:e,content:t.content,dt:(0,s.default)().format("YYYY-MM-DD HH:mm:ss")};"所有人"==i.to?d.default.emit("speak_to_all",i):(i.target_oid=window.target_player.openid,d.default.emit("speak_to_target",i)),n.chat_log.insert(i),t.content="",t.chat_log=n.chat_log.find({})})},onReady:function(){var e=this;this.target=window.target_player?window.target_player.nickname:"所有人",c.default.then(function(t){e.chat_log=t.chat_log.find({})})},open_img:function(){e('input[type="file"]').click()},processFile:function(e){var t=this;if(0!=e.target.files.length){var n=e.target.files[0],i=new FileReader;i.onload=function(e){var n=new Image(400,400);n.src=e.target.result,n.onload=function(){t.send(t.resize2_img(n))}},i.readAsDataURL(n)}},resize2_img:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return n.clearRect(0,0,t.width,t.height),n.drawImage(e,0,0,e.width,e.height),t.toDataURL("image/png")}}}}).call(t,n(8))},234:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=i(a),r=n(48),s=i(r),l=n(67),c=i(l);o.default.directive("tap",{isFn:!0,bind:function(e,t){e.on("tap",t.value)}}),t.default={name:"DesignPage",props:{app:{type:Object,require:!0}},data:function(){return{strokeName:"",comments:"",dirty:!1}},mounted:function(){var e=this;this.app.on({page:"design",preventClose:!0},this);var t=document.querySelector("#design .content canvas"),n=t.parentNode.getBoundingClientRect();t.width=n.width,t.height=n.height;var i={touchstart:function(t){t.clear(),e.dirty=!0}};this.reg_canvas=new c.default(t,i)},methods:{onReady:function(){e("body").on("touchmove",function(e){e.preventDefault()})},onClose:function(e){if(this.dirty){var t=phonon.confirm("手势尚未保存，确认放弃修改吗？","确认离开？",!0,"放弃修改","取消");t.on("confirm",function(){e.close()})}else e.close()},onHidden:function(){e("body").off("touchmove"),this.dirty=!1,this.reg_canvas.clear(),this.comments=""},onHashChanged:function(e){this.strokeName=decodeURIComponent(e),this.stroke=s.default.GetUnistroke(this.strokeName),this.comments=this.stroke.Comments,this.reg_canvas.draw_stroke(this.stroke.Name)},onSave:function(e){this.dirty&&(this.strokeName&&this.comments?(this.dirty=!1,this.reg_canvas.save(this.strokeName,this.comments),phonon.alert(this.strokeName+" 手势已保存","保存成功",!0,"确定")):phonon.alert("名称或备注不能为空","请填写信息",!0,"确定"))}}}}).call(t,n(8))},235:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(243),o=i(a),r=n(67),s=i(r);t.default={name:"GamePage",props:{app:{type:Object,require:!0}},data:function(){return{online_count:0,show_head_panel:!1,cur_x:0,cur_y:0,info:"",wi:{openid:"",nickname:"",sex:"",language:"",city:"",province:"",country:"",headimgurl:""}}},computed:{headimgurl:function(){return/http/i.test(this.wi.headimgurl)?this.wi.headimgurl:"res/hi0.jpg"}},created:function(){var e=this;this.$root.$on("debug_info",function(t){e.info=t}),this.$root.$on("player_coordinate",function(t){e.cur_x=parseFloat(t.x).toFixed(2),e.cur_y=parseFloat(t.y).toFixed(2)}),this.$root.$on("show_header",function(t){window.target_player=t,e.show_header(t)}),this.$root.$on("count_changed",function(t){e.online_count=t})},methods:{clear_target:function(){this.show_head_panel=!1,window.target_player=null},show_profile:function(){phonon.navigator().changePage("profile","")},show_header:function(e){this.show_head_panel=!0,this.wi=e},goHelp:function(){phonon.navigator().changePage("help","margherita")},onReady:function(){e("body").on("touchmove",function(e){e.preventDefault()})},onClose:function(e){alert("onClose"),e.close()},onHidden:function(){e("body").off("touchmove")}},mounted:function(){this.app.on({page:"game",preventClose:!1,content:null},this);var e=document.querySelector("#game_main .content canvas");this.reg_canvas=new s.default(e,o.default);var t=e.parentNode.getBoundingClientRect();e.width=t.width,e.height=t.height}}}).call(t,n(8))},236:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=(i(a),n(48)),r=i(o),s=n(7),l=i(s);t.default={name:"GesturesPage",props:{app:{type:Object,require:!0}},created:function(){this.recognizer=r.default},data:function(){return{strokes:[]}},computed:{libs:function(){return this.recognizer.StringifyGestures()}},mounted:function(){this.app.on({page:"gestures",preventClose:!1,content:null},this)},methods:{get_default_gestures:function(){var t=this;e.get("/static/default_gestures.txt",function(e,n){"success"==n?(r.default.Clear(),r.default.ParseInGestures(e),l.default.then(function(t){t.gestures.remove(t.gestures.find({})),t.gestures.insert({gestures:e})}),t.onReady(),phonon.alert("恢复默认手持成功","手势已重置")):alert("获取默认手势失败:"+n)})},save_gestures:function(){var t=this.recognizer.StringifyGestures();e.ajax({type:"POST",url:"save_gestures",contentType:"application/json; charset=utf-8",timeout:5e3,data:t,dataType:"text"}).done(function(e){phonon.notif("手势保存成功",3e3,!0,"取消")}).fail(function(e){})},delete_stroke:function(e){this.recognizer.DeleteByName(e),this.onReady()},onReady:function(){var e=this;this.strokes=this.recognizer.GetUnistrokes().slice(0),this.$nextTick(function(){e.drawStrokes()})},goDesign:function(e){phonon.navigator().changePage("design",e)},drawStrokes:function(){var e=this;this.recognizer.GetUnistrokes().forEach(function(t){var n=document.getElementById(t.Name),i=n.getContext("2d");i.clearRect(0,0,n.width,n.height),i.beginPath();var a={X:125,Y:130},o=e.recognizer.GetGesturePoints(t.Name,200,a);i.moveTo(o[0].X,o[0].Y);for(var r=1;r<o.length;++r)i.lineTo(o[r].X,o[r].Y),i.stroke()})}}}}).call(t,n(8))},237:function(e,t,n){(function(e){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=i(a),r=n(7),s=i(r);o.default.directive("tap",{isFn:!0,bind:function(e,t){e.on("tap",t.value)}}),t.default={name:"GoodsPage",props:{app:{type:Object,require:!0}},data:function(){return{goods:[],newItem:!1,new_title:"",new_comments:"",new_img:"",new_price:0}},mounted:function(){this.app.on({page:"goods",preventClose:!1},this)},methods:{onReady:function(){var e=this;s.default.then(function(t){e.goods=t.products.find({}),0==e.goods.length?e.$root.$emit("notify_seller_status",{openid:wi.openid,seller:null}):e.$root.$emit("notify_seller_status",{openid:wi.openid,seller:!0})})},open_img:function(){e('input[type="file"]').click()},processFile:function(e){var t=this;if(0!=e.target.files.length){var n=e.target.files[0],i=new FileReader;i.onload=function(e){t.new_img=e.target.result},i.readAsDataURL(n)}},addGoods:function(){var t=this,n=e("#new_img")[0];if(""==n.getAttribute("src"))return void phonon.alert("商品图片不能为空","请填写商品信息");if(this.new_price=parseFloat(this.new_price).toFixed(2),!this.new_title||!this.new_comments||this.new_price<=0)return void phonon.alert("商品 （名称、备注） 不能为空；价格需大于0","请填写商品信息");this.newItem=!1,this.goods=this.goods.splice(0);var i={title:this.new_title,comments:this.new_comments,price:this.new_price,img:this.resize2_img(n)};s.default.then(function(e){e.products.insert(i),t.onReady()})},saveGoods:function(e){var t=this;console.log(e),s.default.then(function(n){n.products.findAndUpdate({$loki:e.$loki},function(t){return e}),phonon.alert("商品信息修改成功","除了图片"),t.onReady()})},delete_item:function(e){var t=this;s.default.then(function(n){n.products.remove(e),t.onReady()})},resize2_img:function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return n.clearRect(0,0,t.width,t.height),n.drawImage(e,0,0,e.width,e.height),t.toDataURL("image/png")}}}}).call(t,n(8))},238:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=i(a);o.default.directive("tap",{isFn:!0,bind:function(e,t){e.on("tap",t.value)}}),t.default={name:"HelpPage",props:{app:{type:Object,require:!0}},data:function(){return{pizza:"",action:null}},mounted:function(){this.app.on({page:"help",preventClose:!1},this)},methods:{}}},239:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=(i(a),n(7)),r=i(o),s=n(66);i(s);t.default={name:"NotyPage",props:{app:{type:Object,require:!0}},created:function(){var e=this;this.$root.$on("refresh_sys_noty",function(t){r.default.then(function(t){e.msgs=t.notification.find({})})})},data:function(){return{msgs:[]}},mounted:function(){this.app.on({page:"noty",preventClose:!1},this)},methods:{onReady:function(){var e=this;r.default.then(function(t){e.msgs=t.notification.find({})})}}}},240:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(15),o=i(a),r=n(7),s=(i(r),n(66));i(s);t.default={name:"OrderPage",props:{app:{type:Object,require:!0}},created:function(){var e=this;this.$root.$on("refresh_order_status",function(t){o.default.get_orders(wi.openid,function(t){return e.orders=t})})},data:function(){return{orders:[],state_dealer:null}},mounted:function(){this.app.on({page:"order",preventClose:!1},this)},methods:{onReady:function(){var e=this;o.default.get_orders(wi.openid,function(t){return e.orders=t})},get_caption:function(e){return"已付款"==e.status&&e.seller_id==wi.openid?(this.state_dealer=function(){o.default.emit("change_order_status",{oid:e.oid,to_status:"已发货"})},"发货"):"已发货"==e.status&&e.buyer_id==wi.openid?(this.state_dealer=function(){o.default.emit("change_order_status",{oid:e.oid,to_status:"已完成"})},"确认收货"):(this.state_dealer=null,"")},do_action:function(e){this.state_dealer&&this.state_dealer()}}}},241:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(10);i(a);t.default={name:"ProfilePage",props:{app:{type:Object,require:!0}},data:function(){return{player:{}}},computed:{headimgurl:function(){return/http/i.test(this.player.headimgurl)?this.player.headimgurl:"res/hi0.jpg"}},mounted:function(){this.app.on({page:"profile",preventClose:!1},this)},methods:{onReady:function(){this.player=target_player},onClose:function(e){},onHidden:function(){},onHashChanged:function(e){}}}},242:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return[[e,t],[e,t-1],[e+1,t-1],[e+1,t],[e+1,t+1],[e,t+1],[e-1,t+1],[e-1,t],[e-1,t-1]]}function o(e,t,n){var i=Math.floor(n.x/p),o=Math.floor(n.y/v);if(n.last_map&&n.last_map.x==i&&n.last_map.y==o)return t;n.last_map={x:i,y:o};var r=a(i,o),s=t.loaded_world_map;r.map(function(n){var i=n[0],a=n[1];if(s[i]||(s[i]={}),!s[i][a]&&t.candidate.length>0){var o=e.randomInt(0,t.candidate.length-1),r=t.candidate[o].clone();r.map_x=i,r.map_y=a,t.addChild(r),r.setPosition(i*p,a*v),s[i][a]=r}return s[i][a]});return t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(245),s=i(r),l=n(31),c=i(l),u=n(32),d=i(u),h=n(15),f=i(h),p=512,v=512,g=function(){function e(t,n,i,a){var r=this;(0,c.default)(this,e),this.g=t,this.world=n,this.wi=i,this.player=t.sprite(t.filmstrip("res/walkcycle.png",64,64)),this.title=t.text(i.nickname),this.sign=this.g.sprite("sell.png"),this.player.x=i.x||t.randomInt(n.world_center-100,n.world_center+100),this.player.y=i.y||t.randomInt(n.world_center-100,n.world_center+100),n.add(this.player,this.title,this.sign),this.player.putTop(this.title),this.player.setLayer=function(e){r.player.layer=e,r.title.layer=e-1,r.sign.layer=e-2},this.is_main_player=a,a&&(this.camera=t.worldCamera(n,t.canvas),this.camera.centerOver(this.player),o(t,n,this.player)),this.player.collisionArea={x:22,y:44,width:20,height:20},this.states={up:0,left:9,down:18,right:27,walkUp:[1,8],walkLeft:[10,17],walkDown:[19,26],walkRight:[28,35]},this.last_face2=this.states.right,this.player.show(this.last_face2),this.player.fps=18,this.seller=i.seller,this.show_sign(i.seller)}return(0,d.default)(e,[{key:"show_sign",value:function(e){this.seller=e,e?this.sign.visible=!0:this.sign.visible=!1}},{key:"get_loc",value:function(){return{x:this.player.x,y:this.player.y}}},{key:"stop_move",value:function(){this.player.vx=this.player.vy=0}},{key:"on_hit",value:function(){if(this.is_main_player){this.stop_move();var e=this.get_loc();e.openid=this.wi.openid,f.default.emit("stop_move",e)}window.vm.$emit("show_header",this.wi)}},{key:"test_hit",value:function(e,t){var n=!1,i=this.player;if(i.circular){var a=e-(i.gx+i.halfWidth),o=t-(i.gy+i.halfHeight),r=Math.sqrt(a*a+o*o);n=r<i.radius}else var s=i.gx,l=i.gx+i.width,c=i.gy,u=i.gy+i.height,n=e>s&&e<l&&t>c&&t<u;return n}},{key:"vanish",value:function(){this.g.remove(this.sign),this.g.remove(this.title),this.g.remove(this.player)}},{key:"update",value:function(){this.player.setLayer(9),this.player.putTop(this.title),this.title.putTop(this.sign),this.animate(),this.do_move(),this.camera&&(window.vm.$emit("player_coordinate",{x:this.player.x-this.world.world_center,y:this.player.y-this.world.world_center}),this.camera.follow(this.player),o(this.g,this.world,this.player))}},{key:"animate",value:function(){return 0==this.player.vx&&0==this.player.vy?(this.player.show(this.last_face2),void(this.player.can_play_anim=!0)):void(this.player.vx>0?this.player.vx>Math.abs(this.player.vy)?(this.player.can_play_anim||this.last_face2!=this.states.right)&&(this.player.playSequence(this.states.walkRight),this.last_face2=this.states.right,this.player.can_play_anim=!1):this.player.vy>0?(this.player.can_play_anim||this.last_face2!=this.states.down)&&(this.player.playSequence(this.states.walkDown),this.last_face2=this.states.down,this.player.can_play_anim=!1):(this.player.can_play_anim||this.last_face2!=this.states.up)&&(this.player.playSequence(this.states.walkUp),this.last_face2=this.states.up,this.player.can_play_anim=!1):Math.abs(this.player.vx)>Math.abs(this.player.vy)?(this.player.can_play_anim||this.last_face2!=this.states.left)&&(this.player.playSequence(this.states.walkLeft),this.last_face2=this.states.left,this.player.can_play_anim=!1):this.player.vy>0?(this.player.can_play_anim||this.last_face2!=this.states.down)&&(this.player.playSequence(this.states.walkDown),this.last_face2=this.states.down,this.player.can_play_anim=!1):(this.player.can_play_anim||this.last_face2!=this.states.up)&&(this.player.playSequence(this.states.walkUp),this.last_face2=this.states.up,this.player.can_play_anim=!1))}},{key:"do_move",value:function(){this.g.move(this.player),this.g.contain(this.player,this.world)}},{key:"translate",value:function(e,t){this.player.x=e,this.player.y=t;
}},{key:"move",value:function(e,t){console.log(e,t);var n=Math.sqrt(e*e+t*t);e/=n,t/=n;var i=this.player;i.vy=2*t,i.vx=2*e,clearTimeout(i.fatigue_tm),function e(){i.vx=Math.abs(i.vx)>.5?Math.max(0,Math.abs(i.vx)-.1)*(0,s.default)(i.vx):0,i.vy=Math.abs(i.vy)>.5?Math.max(0,Math.abs(i.vy)-.1)*(0,s.default)(i.vy):0,Math.abs(i.vx)>0||Math.abs(i.vy)>0?i.fatigue_tm=setTimeout(e,1e3):console.log("player.vx,player.vy all == 0")}()}},{key:"init",value:function(){}}]),e}();t.default=g},243:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(47),o=i(a),r=n(15),s=i(r);t.default={"帮助":function(e,t){phonon.navigator().changePage("help","")},"聊天":function(e,t){phonon.navigator().changePage("chat","")},"商品":function(e,t){phonon.navigator().changePage("goods","")},"购买":function(e,t){return target_player?void(target_player.seller?s.default.emit("get_target_goods",target_player.openid,function(e){target_player.goods=e,phonon.navigator().changePage("buy","")}):phonon.alert("对方不是卖家","无商品可买")):void phonon.alert("未选择购买目标","请先选择玩家")},"订单":function(e,t){phonon.navigator().changePage("order","")},"通知":function(e,t){phonon.navigator().changePage("noty","")},"手势":function(e,t){phonon.navigator().changePage("gestures","")},no_recognize:function(e){console.log("in no_recognize"),e[e.length-1].X||e.pop();var t=e[0],n=e[e.length-1],i=n.X-t.X,a=n.Y-t.Y;o.default.mplayer.move(i,a);var r=o.default.mplayer.get_loc();r.openid=wi.openid,r.dx=i,r.dy=a,s.default.emit("player_move",r)},few_touch:function(e,t){e[e.length-1].X||e.pop();var n=e[e.length-1];o.default.test_hit(n.X,n.Y)},touchstart:function(e){},touchend:function(e){e.clear()}}},244:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var a=n(49),o=i(a),r=n(248),s=i(r),l=n(246),c=i(l),u=u||{};u.VERSION="0.0.1",u.plugins=void 0,u.custom=void 0,u.create=function(e,t,n,i,a){function o(){if(requestAnimationFrame(o,v.canvas),void 0===v._fps)r(),v.render(v.canvas,0);else{var e=Date.now(),t=e-v._startTime;for(t>1e3&&(t=v._frameDuration),v._startTime=e,v._lag+=t;v._lag>=v._frameDuration;)!function(){function e(t){t._previousX=t.x,t._previousY=t.y,t.children&&t.children.length>0&&t.children.forEach(function(t){e(t)})}v.stage.children.forEach(function(t){e(t)})}(),r(),v._lag-=v._frameDuration;var n=v._lag/v._frameDuration;v.render(v.canvas,n)}}function r(){if(v.buttons.length>0){v.canvas.style.cursor="auto";for(var e=v.buttons.length-1;e>=0;e--){var t=v.buttons[e];t.update(v.pointer,v.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(v.canvas.style.cursor="pointer")}}if(v.dragAndDrop&&v.pointer.updateDragAndDrop(),v.state&&!v.paused&&v.state(),0!==v.updateFunctions.length)for(var n=0;n<v.updateFunctions.length;n++)(0,v.updateFunctions[n])()}function l(e){e.x=0,e.y=0,e.vx=0,e.vy=0,e.width=0,e.height=0,e.scaleX=1,e.scaleY=1,e.pivotX=.5,e.pivotY=.5,e.rotation=0,e.visible=!0,e.parent=void 0,e.stage=!1,e.shadow=!1,e.shadowColor="rgba(100, 100, 100, 0.5)",e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowBlur=3,e.blendMode=void 0,e._alpha=1,e._draggable=void 0,e._layer=0,e._circular=!1,e._interactive=!1,e._previousX=void 0,e._previousY=void 0,e.children=[],e.addChild=function(t){t.parent&&t.parent.removeChild(t),t.parent=e,e.children.push(t)},e.removeChild=function(t){if(t.parent!==e)throw new Error(t+"is not a child of "+e);e.children.splice(e.children.indexOf(t),1)},e.swapChildren=function(t,n){var i=e.children.indexOf(t),a=e.children.indexOf(n);if(-1===i||-1===a)throw new Error(child+" Both objects must be a child of the caller "+e);t.childIndex=a,n.childIndex=i,e.children[i]=n,e.children[a]=t},e.add=function(t){var n=Array.prototype.slice.call(arguments);n.length>1?n.forEach(function(t){e.addChild(t)}):e.addChild(n[0])},e.remove=function(t){var n=Array.prototype.slice.call(arguments);n.length>1?n.forEach(function(t){e.removeChild(t)}):e.removeChild(n[0])},e.setPosition=function(t,n){e.x=t,e.y=n};var t=e;e.putCenter=function(n,i,a){i=i||0,a=a||0,n.x=t.x+t.halfWidth-n.halfWidth+i,n.y=t.y+t.halfHeight-n.halfHeight+a,e.compensateForParentPosition(t,n)},e.putTop=function(n,i,a){i=i||0,a=a||0,n.x=t.x+t.halfWidth-n.halfWidth+i,n.y=t.y-n.height+a,e.compensateForParentPosition(t,n)},e.putRight=function(n,i,a){i=i||0,a=a||0,n.x=t.x+t.width+i,n.y=t.y+t.halfHeight-n.halfHeight+a,e.compensateForParentPosition(t,n)},e.putBottom=function(n,i,a){i=i||0,a=a||0,n.x=t.x+t.halfWidth-n.halfWidth+i,n.y=t.y+t.height+a,e.compensateForParentPosition(t,n)},e.putLeft=function(n,i,a){i=i||0,a=a||0,n.x=t.x-n.width+i,n.y=t.y+t.halfHeight-n.halfHeight+a,e.compensateForParentPosition(t,n)},e.compensateForParentPosition=function(e,t){e.parent!=t.parent&&(0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy))},(0,c.default)(e,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0},alpha:{get:function(){return e.parent._alpha*e._alpha},set:function(t){e._alpha=t},enumerable:!0,configurable:!0},halfWidth:{get:function(){return e.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return e.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x+e.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y+e.halfHeight},enumerable:!0,configurable:!0},layer:{get:function(){return e._layer},set:function(t){e._layer=t,e.parent.children.sort(p)},enumerable:!0,configurable:!0},circular:{get:function(){return e._circular},set:function(t){!0===t&&!1===e._circular&&(d(e),e._circular=!0),!1===t&&!0===e._circular&&(delete e.diameter,delete e.radius,e._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:function(){return e._draggable},set:function(t){!0===t&&(v.draggableSprites.push(e),e._draggable=!0,!1===v.dragAndDrop&&(v.dragAndDrop=!0)),!1===t&&v.draggableSprites.splice(v.draggableSprites.indexOf(e),1)},enumerable:!0,configurable:!0},interactive:{get:function(){return e._interactive},set:function(t){!0===t&&(h(e),e._interactive=!0),!1===t&&(v.buttons.splice(v.buttons.indexOf(e),1),e._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:function(){return{x:0,y:0,width:e.width,height:e.height}},enumerable:!0,configurable:!0},globalBounds:{get:function(){return rectangle={x:e.gx,y:e.gy,width:e.gx+e.width,height:e.gy+e.height},rectangle},enumerable:!0,configurable:!0},empty:{get:function(){return 0===e.children.length},enumerable:!0,configurable:!0}})}function d(e){(0,c.default)(e,{diameter:{get:function(){return e.width},set:function(t){e.width=t,e.height=t},enumerable:!0,configurable:!0},radius:{get:function(){return e.width/2},set:function(t){e.width=2*t,e.height=2*t},enumerable:!0,configurable:!0}})}function h(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.pressed=!1,e.enabled=!0,e.hoverOver=!1,v.buttons.push(e),e.update=function(t,n){if(e.enabled){var i=v.pointer.hitTestSprite(e);t.isUp&&(e.state="up","button"===e.subtype&&e.show(0)),i&&(e.state="over",e.frames&&3===e.frames.length&&"button"===e.subtype&&e.show(1),t.isDown&&(e.state="down","button"===e.subtype&&(3===e.frames.length?e.show(2):e.show(1)))),"down"===e.state&&(e.pressed||(e.press&&e.press(),e.pressed=!0,e.action="pressed")),"over"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released",v.pointer.tapped&&e.tap&&e.tap()),e.hoverOver||(e.over&&e.over(),e.hoverOver=!0)),"up"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released"),e.hoverOver&&(e.out&&e.out(),e.hoverOver=!1))}}}function f(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},v.canvas.addEventListener("keydown",t.downHandler.bind(t),!1),v.canvas.addEventListener("keyup",t.upHandler.bind(t),!1),t}function p(e,t){return e.layer<t.layer?-1:(e.layer,t.layer,1)}var v={};if(v.canvas=document.createElement("canvas"),v.canvas.setAttribute("width",1*e),v.canvas.setAttribute("height",1*t),v.canvas.style.backgroundColor="black",document.body.appendChild(v.canvas),v.canvas.ctx=v.canvas.getContext("2d"),v.stage=function(){var e={};return l(e),e.stage=!0,e.width=v.canvas.width,e.height=v.canvas.height,e.x=0,e.y=0,e.parent=void 0,e}(),v.pointer=function(){var e={};return e._x=0,e._y=0,(0,c.default)(e,{x:{get:function(){return e._x/v.scale},enumerable:!0,configurable:!0},y:{get:function(){return e._y/v.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0}}),e.isDown=!1,e.isUp=!0,e.tapped=!1,e.downTime=0,e.elapsedTime=0,e.press=void 0,e.release=void 0,e.tap=void 0,e.dragSprite=null,e.dragOffsetX=0,e.dragOffsetY=0,e.moveHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,t.preventDefault()},e.touchmoveHandler=function(t){e._x=t.targetTouches[0].pageX-v.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-v.canvas.offsetTop,t.preventDefault()},e.downHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.touchstartHandler=function(t){e._x=t.targetTouches[0].pageX-v.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-v.canvas.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.upHandler=function(t){e.elapsedTime=Math.abs(e.downTime-Date.now()),e.elapsedTime<=200&&(e.tapped=!0,e.tap&&e.tap()),e.isUp=!0,e.isDown=!1,e.release&&e.release(),t.preventDefault()},v.canvas.addEventListener("mousemove",e.moveHandler.bind(e),!1),v.canvas.addEventListener("mousedown",e.downHandler.bind(e),!1),v.canvas.addEventListener("mouseup",e.upHandler.bind(e),!1),v.canvas.addEventListener("touchmove",e.touchmoveHandler.bind(e),!1),v.canvas.addEventListener("touchstart",e.touchstartHandler.bind(e),!1),v.canvas.addEventListener("touchend",e.upHandler.bind(e),!1),v.canvas.style.touchAction="none",e.hitTestSprite=function(t){if(l=!1,t.circular){var n=e.x-(t.gx+t.halfWidth),i=e.y-(t.gy+t.halfHeight);l=Math.sqrt(n*n+i*i)<t.radius}else var a=t.gx,o=t.gx+t.width,r=t.gy,s=t.gy+t.height,l=e.x>a&&e.x<o&&e.y>r&&e.y<s;return l},e.updateDragAndDrop=function(){if(e.isDown)if(null===e.dragSprite)for(var t=v.draggableSprites.length-1;t>-1;t--){var n=v.draggableSprites[t];if(n.draggable&&e.hitTestSprite(n)){e.dragOffsetX=e.x-n.gx,e.dragOffsetY=e.y-n.gy,e.dragSprite=n;var i=n.parent.children;i.splice(i.indexOf(n),1),i.push(n),v.draggableSprites.splice(v.draggableSprites.indexOf(n),1),v.draggableSprites.push(n);break}}else e.dragSprite.x=e.x-e.dragOffsetX,e.dragSprite.y=e.y-e.dragOffsetY;e.isUp&&(e.dragSprite=null),v.draggableSprites.some(function(t){return t.draggable&&e.hitTestSprite(t)?(v.canvas.style.cursor="pointer",!0):(v.canvas.style.cursor="auto",!1)})},e}(),v.key=function(){var e={};return e.leftArrow=f(37),e.upArrow=f(38),e.rightArrow=f(39),e.downArrow=f(40),e.space=f(32),e}(),v.buttons=[],v.dragAndDrop=!1,v.draggableSprites=[],v.tweens=[],v.state=void 0,v.load=a||void 0,v.setup=n||void 0,void 0===v.setup)throw new Error("Please supply the setup function in the constructor");return v.assetFilePaths=i||void 0,v.paused=!1,v._fps=60,v._startTime=Date.now(),v._frameDuration=1e3/v._fps,v._lag=0,v.interpolate=!0,v.updateFunctions=[],v.scale=1,v.start=function(){v.assetFilePaths?(v.assets.whenLoaded=function(){v.state=void 0,v.setup()},v.assets.load(v.assetFilePaths),v.load&&(v.state=v.load)):v.setup(),o()},v.pause=function(){v.paused=!0},v.resume=function(){v.paused=!1},v.hidePointer=function(){v.canvas.style.cursor="none"},v.showPointer=function(){v.canvas.style.cursor="auto"},(0,c.default)(v,{fps:{get:function(){return v._fps},set:function(e){v._fps=e,v._startTime=Date.now(),v._frameDuration=1e3/v._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){v.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),v.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var n=t[0];if(n.length>0)for(var i=n.length-1;i>=0;i--){var a=n[i];a.parent.removeChild(a),n.splice(n.indexOf(a),1)}}else t.length>1?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},v.group=function(e){var t={};return l(t),t.addChild=function(e){e.parent&&e.parent.removeChild(e),e.parent=t,t.children.push(e),t.calculateSize()},t.removeChild=function(e){if(e.parent!==t)throw new Error(e+"is not a child of "+t);t.children.splice(t.children.indexOf(e),1),t.calculateSize()},t.calculateSize=function(){t.children.length>0&&(t._newWidth=0,t._newHeight=0,t.children.forEach(function(e){e.x+e.width>t._newWidth&&(t._newWidth=e.x+e.width),e.y+e.height>t._newHeight&&(t._newHeight=e.y+e.height)}),t.width=t._newWidth,t.height=t._newHeight)},v.stage.addChild(t),e&&Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)}),t},v.spreadGroup=function(e){var t={};return l(t),t.calculateSize=function(){if(t.children.length>0){var e=0,n=0,i=0,a=0;t.children.forEach(function(t){t.x<e&&(e=t.x),t.y<n&&(n=t.y),t.x+t.width>i&&(i=t.x+t.width),t.y+t.height>a&&(a=t.y+t.height)}),t.setPosition(e+t.x,n+t.y),t.width=i-e,t.height=a-n,t.origin={x:t.x,y:t.y,width:t.width,height:t.height}}},v.stage.addChild(t),e&&Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)}),t},v.staticGroup=function(e){var t={};return l(t),v.stage.addChild(t),e&&Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)}),t},v.rectangle=function(e,t,n,i,a,o,r){var s={};return l(s),s.mask=!1,s.width=e||32,s.height=t||32,s.fillStyle=n||"red",s.strokeStyle=i||"none",s.lineWidth=a||0,s.x=o||0,s.y=r||0,v.stage.addChild(s),s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,e.beginPath(),e.rect(-s.width*s.pivotX,-s.height*s.pivotY,s.width,s.height),!0===s.mask?e.clip():("none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill())},s},v.circle=function(e,t,n,i,a,o){var r={};return l(r),r.mask=!1,r.width=e||32,r.height=e||32,r.fillStyle=t||"red",r.strokeStyle=n||"none",r.lineWidth=i||"none",r.x=a||0,r.y=o||0,v.stage.addChild(r),d(r),r.render=function(e){e.strokeStyle=r.strokeStyle,e.lineWidth=r.lineWidth,e.fillStyle=r.fillStyle,e.beginPath(),e.arc(r.radius+-r.diameter*r.pivotX,r.radius+-r.diameter*r.pivotY,r.radius,0,2*Math.PI,!1),!0===r.mask?e.clip():("none"!==r.strokeStyle&&e.stroke(),"none"!==r.fillStyle&&e.fill())},r},v.line=function(e,t,n,i,a,o){var r={};return l(r),n||0===n||(n=0),i||0===i||(i=0),a||0===a||(a=32),o||0===o||(o=32),r.ax=n,r.ay=i,r.bx=a,r.by=o,r.strokeStyle=e||"red",r.lineWidth=t||1,r.lineJoin="round",v.stage.addChild(r),r.render=function(e){e.strokeStyle=r.strokeStyle,e.lineWidth=r.lineWidth,e.lineJoin=r.lineJoin,e.beginPath(),e.moveTo(r.ax,r.ay),e.lineTo(r.bx,r.by),"none"!==r.strokeStyle&&e.stroke(),"none"!==r.fillStyle&&e.fill()},r},v.text=function(e,t,n,i,a){var o={};return l(o),o.content=e||"Hello!",o.font=t||"12px sans-serif",o.fillStyle=n||"red",o.textBaseline="top",(0,c.default)(o,{width:{get:function(){return v.canvas.ctx.measureText(o.content).width},enumerable:!0,configurable:!0},height:{get:function(){return v.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),v.stage.addChild(o),o.x=i||0,o.y=a||0,o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.fillStyle=o.fillStyle,0===o.width&&(o.width=e.measureText(o.content).width),0===o.height&&(o.height=e.measureText("M").width),e.translate(-o.width*o.pivotX,-o.height*o.pivotY),e.font=o.font,e.textBaseline=o.textBaseline,e.fillText(o.content,0,0)},o},v.frame=function(e,t,n,i,a){var o={};return o.image=e,o.x=t,o.y=n,o.width=i,o.height=a,o},v.frames=function(e,t,n,i){var a={};return a.image=e,a.data=t,a.width=n,a.height=i,a},v.filmstrip=function(e,t,n,i){for(var a=v.assets[e].source,o=[],r=a.width/t,s=r*(a.height/n),l=0;l<s;l++){var c,u;c=l%r*t,u=Math.floor(l/r)*n,i&&i>0&&(c+=i+i*l%r,u+=i+i*Math.floor(l/r)),o.push([c,u])}return v.frames(e,o,t,n)},v.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return l(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){if(e.image)if(e.image&&!e.data){if(!(v.assets[e.image].source instanceof Image))throw new Error(e.image+" is not an image file");t.source=v.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e.image&&e.data&&(t.source=v.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else e instanceof Array?(t.frames=e,t.source=v.assets[e[0]].source,t.sourceX=v.assets[e[0]].frame.x,t.sourceY=v.assets[e[0]].frame.y,t.width=v.assets[e[0]].frame.w,t.height=v.assets[e[0]].frame.h,t.sourceWidth=v.assets[e[0]].frame.w,t.sourceHeight=v.assets[e[0]].frame.h):(t.tilesetFrame=v.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=function(e){if(!(t.frames.length>0))throw new Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):v.assets[t.frames[e]].frame&&(t.source=v.assets[t.frames[e]].source,t.sourceX=v.assets[t.frames[e]].frame.x,t.sourceY=v.assets[t.frames[e]].frame.y,t.sourceWidth=v.assets[t.frames[e]].frame.w,t.sourceHeight=v.assets[t.frames[e]].frame.h,t.width=v.assets[t.frames[e]].frame.w,t.height=v.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,t.y=0,t.frames.length>0&&(v.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:function(){return t._currentFrame},enumerable:!1,configurable:!1})),v.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},v.button=function(e){var t=v.sprite(e);return t.subtype="button",h(t),t},v.image=function(e){return v.assets[e]},v.json=function(e){return v.assets[e]},v.addStatePlayer=function(e){function t(t){n(),o=t[0],r=t[1],a=r-o,0===o&&(a+=1,i+=1),1===a&&(a=2,i+=1),e.fps||(e.fps=12);var c=1e3/e.fps;e.gotoAndStop(o),l||(s=setInterval(function(){i<a?(e.gotoAndStop(e.currentFrame+1),i+=1):e.loop&&(e.gotoAndStop(o),i=1)}.bind(this),c),l=!0)}function n(){void 0!==s&&!0===l&&(l=!1,i=0,o=0,r=0,a=0,clearInterval(s))}var i=0,a=0,o=0,r=0,s=void 0,l=!1;e.show=function(t){n(),"string"!=typeof t?e.gotoAndStop(t):e.gotoAndStop(e.frames.indexOf(t))},e.play=function(){t([0,e.frames.length-1])},e.stop=function(){n(),e.gotoAndStop(e.currentFrame)},e.playing=l,e.playSequence=t},v.render=function(e,t){function n(a){if(a.visible&&a.gx<e.width+a.width&&a.gx+a.width>=-a.width&&a.gy<e.height+a.height&&a.gy+a.height>=-a.height){if(i.save(),v.interpolate?(void 0!==a._previousX?a.renderX=(a.x-a._previousX)*t+a._previousX:a.renderX=a.x,void 0!==a._previousY?a.renderY=(a.y-a._previousY)*t+a._previousY:a.renderY=a.y):(a.renderX=a.x,a.renderY=a.y),i.translate(a.renderX+a.width*a.pivotX,a.renderY+a.height*a.pivotY),i.globalAlpha=a.alpha,i.rotate(a.rotation),i.scale(a.scaleX,a.scaleY),a.shadow&&(i.shadowColor=a.shadowColor,i.shadowOffsetX=a.shadowOffsetX,i.shadowOffsetY=a.shadowOffsetY,i.shadowBlur=a.shadowBlur),a.blendMode&&(i.globalCompositeOperation=a.blendMode),a.render&&a.render(i),a.children&&a.children.length>0){i.translate(-a.width*a.pivotX,-a.height*a.pivotY);for(var o=0;o<a.children.length;o++)n(a.children[o])}i.restore()}}var i=e.ctx;i.clearRect(0,0,e.width,e.height);for(var a=0;a<v.stage.children.length;a++)n(v.stage.children[a])},v.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load:function(e){console.log("Loading assets...");var t=this;t.toLoad=e.length,e.forEach(function(e){var n=e.split(".").pop();if(-1!==t.imageExtensions.indexOf(n)){var i=new Image;i.addEventListener("load",function(){i.name=e,t[i.name]={source:i,frame:{x:0,y:0,w:i.width,h:i.height}},t.loadHandler()},!1),i.src=e}else if(-1!==t.fontExtensions.indexOf(n)){var a=e.split("/").pop().split(".")[0],o=document.createElement("style"),r="@font-face {font-family: '"+a+"'; src: url('"+e+"');}";o.appendChild(document.createTextNode(r)),document.head.appendChild(o),t.loadHandler()}else if(-1!==t.audioExtensions.indexOf(n)){var s=v.makeSound(e,t.loadHandler.bind(t));s.name=e,t[s.name]=s}else if(-1!==t.jsonExtensions.indexOf(n)){var l=new XMLHttpRequest,c={};l.open("GET",e,!0),l.addEventListener("readystatechange",function(){200===l.status&&4===l.readyState&&((c=JSON.parse(l.responseText)).name=e,t[c.name]=c,c.frames?t.createTilesetFrames(c,e):t.loadHandler())}),l.send()}else console.log("File type not recognized: "+e)})},createTilesetFrames:function(e,t){var n=this,i=t.replace(/[^\/]*$/,""),a=new Image;a.addEventListener("load",function(){n[i+e.meta.image]={source:a,frame:{x:0,y:0,w:a.width,h:a.height}},(0,s.default)(e.frames).forEach(function(t){n[t]=e.frames[t],n[t].source=a}),n.loadHandler()},!1),a.src=i+e.meta.image},loadHandler:function(){this.loaded+=1,console.log(this.loaded),this.toLoad===this.loaded&&(this.toLoad=0,this.loaded=0,this.whenLoaded())}},v.keyboard=f,v.makeDisplayObject=l,void 0!==u.plugins&&u.plugins(v),void 0!==u.custom&&u.custom(v),v},window.ga=u.create,!function(e,t,n){function i(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var e=this.internal_createGain();return i(e.gain),e},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(e){var t=e?this.internal_createDelay(e):this.internal_createDelay();return i(t.delayTime),t},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var e=this.internal_createBufferSource();return e.start||(e.start=function(e,t,n){t||n?this.noteGrainOn(e,t,n):this.noteOn(e)}),e.stop||(e.stop=e.noteOff),i(e.playbackRate),e},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var e=this.internal_createDynamicsCompressor();return i(e.threshold),i(e.knee),i(e.ratio),i(e.reduction),i(e.attack),i(e.release),e},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var e=this.internal_createBiquadFilter();return i(e.frequency),i(e.detune),i(e.Q),i(e.gain),e},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();return e.start||(e.start=e.noteOn),e.stop||(e.stop=e.noteOff),i(e.frequency),i(e.detune),e}))}(window),function(e){function t(t,n){var i=e.createEvent("Event");i.initEvent(t,!0,!1),n.dispatchEvent(i)}var n,i,a={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},o=a.w3;for(i in a)if(a[i].enabled in e){n=a[i];break}o.enabled in e||!n||(e.addEventListener(n.events.change,function(i){e[o.enabled]=e[n.enabled],e[o.element]=e[n.element],t(o.events.change,i.target)},!1),e.addEventListener(n.events.error,function(e){t(o.events.error,e.target)},!1),e[o.enabled]=e[n.enabled],e[o.element]=e[n.element],e[o.exit]=e[n.exit],Element.prototype[o.request]=function(){return this[n.request].apply(this,arguments)})}(document),u=u||{},u.plugins=function(e){function t(e){e.x+=e.vx||0,e.y+=e.vy||0}e.move=function(e){if(e instanceof Array==0)t(e);else for(var n=0;n<e.length;n++)t(e[n])},e.distance=function(e,t){var n=t.centerX-e.centerX,i=t.centerY-e.centerY;return Math.sqrt(n*n+i*i)},e.followEase=function(e,t,n){var i=t.centerX-e.centerX,a=t.centerY-e.centerY;Math.sqrt(i*i+a*a)>=1&&(e.x+=i*n,e.y+=a*n)},e.followConstant=function(e,t,n){var i=t.centerX-e.centerX,a=t.centerY-e.centerY,o=Math.sqrt(i*i+a*a);o>=n&&(e.x+=i/o*n,e.y+=a/o*n)},e.rotateAroundSprite=function(e,t,n,i){e.x=t.centerX-e.parent.x+n*Math.cos(i)-e.halfWidth,e.y=t.centerY-e.parent.y+n*Math.sin(i)-e.halfWidth},e.rotateAroundPoint=function(e,t,n,i,a){var o={};return o.x=e+Math.cos(a)*n,o.y=t+Math.sin(a)*i,o},e.angle=function(e,t){return Math.atan2(t.centerY-e.centerY,t.centerX-e.centerX)},e.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.randomFloat=function(e,t){return e+Math.random()*(t-e)},e.wait=function(e,t){return setTimeout(t,e)},e.worldCamera=function(e,t){return{width:t.width,height:t.height,_x:0,_y:0,get x(){return this._x},set x(t){this._x=t,e.x=-this._x,e._previousX=e.x},get y(){return this._y},set y(t){this._y=t,e.y=-this._y,e._previousY=e.y},get centerX(){return this.x+this.width/2},get centerY(){return this.y+this.height/2},get rightInnerBoundary(){return this.x+this.width/2+this.width/4},get leftInnerBoundary(){return this.x+this.width/2-this.width/4},get topInnerBoundary(){return this.y+this.height/2-this.height/4},get bottomInnerBoundary(){return this.y+this.height/2+this.height/4},follow:function(t){t.x<this.leftInnerBoundary&&(this.x=t.x-this.width/4),t.y<this.topInnerBoundary&&(this.y=t.y-this.height/4),t.x+t.width>this.rightInnerBoundary&&(this.x=t.x+t.width-this.width/4*3),t.y+t.height>this.bottomInnerBoundary&&(this.y=t.y+t.height-this.height/4*3);var n=e.origin?e.origin.x:0,i=e.origin?e.origin.y:0;this.x<n&&(this.x=n),this.y<i&&(this.y=i),this.x+this.width>n+e.width&&(this.x=n+e.width-this.width),this.y+this.height>i+e.height&&(this.y=i+e.height-this.height)},centerOver:function(e){this.x=e.x+e.halfWidth-this.width/2,this.y=e.y+e.halfHeight-this.height/2}}},e.scaleToWindow=function(t){t=t||"#2C3539";var n,i,a,o;n=window.innerWidth/e.canvas.width,i=window.innerHeight/e.canvas.height,a=Math.min(n,i),e.canvas.style.transformOrigin="0 0",e.canvas.style.transform="scale("+a+")";var r;"horizontally"==(o=e.canvas.width>e.canvas.height?e.canvas.width*a<window.innerWidth?"horizontally":"vertically":e.canvas.height*a<window.innerHeight?"vertically":"horizontally")&&(r=(window.innerWidth-e.canvas.width*a)/2,e.canvas.style.marginLeft=r+"px",e.canvas.style.marginRight=r+"px"),"vertically"===o&&(r=(window.innerHeight-e.canvas.height*a)/2,e.canvas.style.marginTop=r+"px",e.canvas.style.marginBottom=r+"px"),e.canvas.style.paddingLeft=0,e.canvas.style.paddingRight=0,e.canvas.style.paddingTop=0,e.canvas.style.paddingBottom=0,e.canvas.style.display="block",document.body.style.backgroundColor=t,e.pointer.scale=a,e.scale=a,e.canvas.scaled=!0;var s=navigator.userAgent.toLowerCase();-1!=s.indexOf("safari")&&(s.indexOf("chrome")>-1||(e.canvas.style.maxHeight="100%",e.canvas.style.minHeight="100%"))},e.shakingSprites=[],e.updateShakingSprites=function(){if(e.shakingSprites.length>0)for(var t=e.shakingSprites.length-1;t>=0;t--){var n=e.shakingSprites[t];n.updateShake&&n.updateShake()}},e.updateFunctions.push(e.updateShakingSprites),e.shake=function(t,n,i){void 0===n&&(n=16),void 0===i&&(i=!1);var a=1,o=10,r=t.x,s=t.y,l=t.rotation,c=n/o,u=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};-1===e.shakingSprites.indexOf(t)&&(e.shakingSprites.push(t),t.updateShake=function(){i?(a<o&&(t.rotation=l,n-=c,t.rotation=n*d,a+=1,d*=-1),a>=o&&(t.rotation=l,e.shakingSprites.splice(e.shakingSprites.indexOf(t),1))):(a<o&&(t.x=r,t.y=s,n-=c,t.x+=u(-n,n),t.y+=u(-n,n),a+=1),a>=o&&(t.x=r,t.y=s,e.shakingSprites.splice(e.shakingSprites.indexOf(t),1)))});var d=1},e.tweens=[],e.updateTweens=function(){if(e.tweens.length>0)for(var t=e.tweens.length-1;t>=0;t--){var n=e.tweens[t];n&&n.update()}},e.updateFunctions.push(e.updateTweens),e.cubicBezier=function(e,t,n,i,a){var o=e*e;return t+(3*-t+e*(3*t-t*e))*e+(3*n+e*(-6*n+3*n*e))*e+(3*i-3*i*e)*o+a*(o*e)};var n={linear:function(e){return e},smoothstep:function(e){return e*e*(3-2*e)},smoothstepSquared:function(e){return Math.pow(e*e*(3-2*e),2)},smoothstepCubed:function(e){return Math.pow(e*e*(3-2*e),3)},acceleration:function(e){return e*e},accelerationCubed:function(e){return Math.pow(e*e,3)},deceleration:function(e){return 1-Math.pow(1-e,2)},decelerationCubed:function(e){return 1-Math.pow(1-e,3)},sine:function(e){return Math.sin(e*Math.PI/2)},sineSquared:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},sineCubed:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},inverseSine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},inverseSineSquared:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),2)},inverseSineCubed:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),3)},spline:function(e,t,n,i,a){return.5*(2*n+(-t+i)*e+(2*t-5*n+4*i-a)*e*e+(3*n-t-3*i+a)*e*e*e)}};e.tweenProperty=function(t,i,a,r,s,l,c,u){void 0===s&&(s=60),void 0===l&&(l="smoothstep"),void 0===c&&(c=!1),void 0===u&&(u=0);var d={},h=l.split(" ");return"bounce"===h[0]&&(d.startMagnitude=parseInt(h[1]),d.endMagnitude=parseInt(h[2])),d.start=function(t,n){d.startValue=JSON.parse((0,o.default)(t)),d.endValue=JSON.parse((0,o.default)(n)),d.playing=!0,d.totalFrames=s,d.frameCounter=0,e.tweens.push(d)},d.start(a,r),d.update=function(){var e;if(d.playing)if(d.frameCounter<d.totalFrames){var a=d.frameCounter/d.totalFrames;e="bounce"!==h[0]?n[l](a):n.spline(a,d.startMagnitude,0,1,d.endMagnitude),t[i]=d.endValue*e+d.startValue*(1-e),d.frameCounter+=1}else d.end()},d.end=function(){d.playing=!1,d.onComplete&&d.onComplete(),e.tweens.splice(e.tweens.indexOf(d),1),c&&e.wait(u,function(){d.start(d.endValue,d.startValue)})},d.play=function(){d.playing=!0},d.pause=function(){d.playing=!1},d},e.fadeOut=function(t,n){return void 0===n&&(n=60),e.tweenProperty(t,"alpha",t.alpha,0,n,"sine")},e.fadeIn=function(t,n){return void 0===n&&(n=60),e.tweenProperty(t,"alpha",t.alpha,1,n,"sine")},e.pulse=function(t,n,i){return void 0===n&&(n=60),void 0===i&&(i=0),e.tweenProperty(t,"alpha",t.alpha,i,n,"smoothstep",!0);
},e.makeTween=function(t){var n={};n.tweens=[],t.forEach(function(t){var i=e.tweenProperty(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);n.tweens.push(i)});var i=0;return n.completed=function(){(i+=1)===n.tweens.length&&(n.onComplete&&n.onComplete(),i=0)},n.tweens.forEach(function(e){e.onComplete=function(){n.completed()}}),n.pause=function(){n.tweens.forEach(function(e){e.playing=!1})},n.play=function(){n.tweens.forEach(function(e){e.playing=!0})},n},e.slide=function(t,n,i,a,o,r,s){return void 0===a&&(a=60),void 0===o&&(o="smoothstep"),void 0===r&&(r=!1),void 0===s&&(s=0),e.makeTween([[t,"x",t.x,n,a,o,r,s],[t,"y",t.y,i,a,o,r,s]])},e.breathe=function(t,n,i,a,o,r){return void 0===a&&(a=60),void 0===o&&(o=!0),void 0===r&&(r=0),e.makeTween([[t,"scaleX",t.scaleX,n,a,"smoothstepSquared",o,r],[t,"scaleY",t.scaleY,i,a,"smoothstepSquared",o,r]])},e.scale=function(t,n,i,a){return void 0===a&&(a=60),e.makeTween([[t,"scaleX",t.scaleX,n,a,"smoothstep",!1],[t,"scaleY",t.scaleY,i,a,"smoothstep",!1]])},e.strobe=function(t,n,i,a,o,r,s){void 0===n&&(n=1.3),void 0===i&&(i=10),void 0===a&&(a=20),void 0===o&&(o=10),void 0===r&&(r=!0),void 0===s&&(s=0);var l="bounce "+i+" "+a;return e.makeTween([[t,"scaleX",t.scaleX,n,o,l,r,s],[t,"scaleY",t.scaleY,n,o,l,r,s]])},e.wobble=function(t,n,i,a,o,r,s,l,c,u,d){void 0===n&&(n=1.2),void 0===i&&(i=1.2),void 0===a&&(a=10),void 0===o&&(o=10),void 0===r&&(r=10),void 0===s&&(s=-10),void 0===l&&(l=-10),void 0===c&&(c=.98),void 0===u&&(u=!0),void 0===d&&(d=0);var h="bounce "+o+" "+r,f="bounce "+s+" "+l,p=e.makeTween([[t,"scaleX",t.scaleX,n,a,h,u,d],[t,"scaleY",t.scaleY,i,a,f,u,d]]);return p.tweens.forEach(function(t){t.onComplete=function(){t.endValue>1&&(t.endValue*=c,t.endValue<=1&&(t.endValue=1,e.removeTween(t)))}}),p},e.removeTween=function(t){t.tweens?(t.pause(),t.tweens.forEach(function(t){e.tweens.splice(e.tweens.indexOf(t),1)})):(t.pause(),e.tweens.splice(e.tweens.indexOf(t),1))},e.followCurve=function(t,i,a,r,s,l){void 0===r&&(r="smoothstep"),void 0===s&&(s=!1),void 0===l&&(l=0);var c={},u=r.split(" ");return"bounce"===u[0]&&(c.startMagnitude=parseInt(u[1]),c.endMagnitude=parseInt(u[2])),c.start=function(t){c.playing=!0,c.totalFrames=a,c.frameCounter=0,c.pointsArray=JSON.parse((0,o.default)(t)),e.tweens.push(c)},c.start(i),c.update=function(){var i,a,o=c.pointsArray;c.playing&&(c.frameCounter<c.totalFrames?(i=c.frameCounter/c.totalFrames,a="bounce"!==u[0]?n[r](i):n.spline(i,c.startMagnitude,0,1,c.endMagnitude),t.x=e.cubicBezier(a,o[0][0],o[1][0],o[2][0],o[3][0]),t.y=e.cubicBezier(a,o[0][1],o[1][1],o[2][1],o[3][1]),c.frameCounter+=1):c.end())},c.end=function(){c.playing=!1,c.onComplete&&c.onComplete(),e.tweens.splice(e.tweens.indexOf(c),1),s&&e.wait(l,function(){c.pointsArray=c.pointsArray.reverse(),c.start(c.pointsArray)})},c.pause=function(){c.playing=!1},c.play=function(){c.playing=!0},c},e.walkPath=function(t,n,i,a,r,s,l){function c(n){var i=e.makeTween([[t,"x",u[n][0],u[n+1][0],d,a],[t,"y",u[n][1],u[n+1][1],d,a]]);return i.onComplete=function(){(n+=1)<u.length-1?e.wait(l,function(){i=c(n)}):r&&(s&&u.reverse(),e.wait(l,function(){n=0,t.x=u[0][0],t.y=u[0][1],i=c(n)}))},i}void 0===i&&(i=300),void 0===a&&(a="smoothstep"),void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===l&&(l=0);var u=JSON.parse((0,o.default)(n)),d=i/u.length;return c(0)},e.walkCurve=function(t,n,i,a,o,r,s){function l(i){var u=e.followCurve(t,n[i],c,a);return u.onComplete=function(){(i+=1)<n.length?e.wait(s,function(){u=l(i)}):o&&(r&&(n.reverse(),n.forEach(function(e){e.reverse()})),e.wait(s,function(){i=0,t.x=n[0][0],t.y=n[0][1],u=l(i)}))},u}void 0===i&&(i=300),void 0===a&&(a="smoothstep"),void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===s&&(s=0);var c=i/n.length;return l(0)},e.shoot=function(e,t,n,i,a,o){var r=o();return r.x=e.centerX-r.halfWidth+n*Math.cos(t),r.y=e.centerY-r.halfHeight+n*Math.sin(t),r.vx=Math.cos(t)*i,r.vy=Math.sin(t)*i,a.push(r),r},e.grid=function(t,n,i,a,o,r,s,l,c){void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=32),void 0===a&&(a=32),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=!1);var u=e.group();return u.createGrid=function(){for(var e=t*n,d=0;d<e;d++){var h=d%t*i,f=Math.floor(d/t)*a,p=l();u.addChild(p),o?(p.x=h+i/2-p.halfWidth+r,p.y=f+a/2-p.halfHeight+s):(p.x=h+r,p.y=f+s),c&&c(p)}},u.createGrid(),e.stage.addChild(u),u},e.progressBar={maxWidth:0,height:0,backgroundColor:"gray",foregroundColor:"cyan",backBar:null,frontBar:null,percentage:null,assets:null,initialized:!1,create:function(t,n){this.initialized||(this.assets=n,this.maxWidth=e.canvas.width/2,this.backBar=e.rectangle(this.maxWidth,32,this.backgroundColor),this.backBar.x=e.canvas.width/2-this.maxWidth/2,this.backBar.y=e.canvas.height/2-16,this.frontBar=e.rectangle(this.maxWidth,32,this.foregroundColor),this.frontBar.x=e.canvas.width/2-this.maxWidth/2,this.frontBar.y=e.canvas.height/2-16,this.percentage=e.text("0%","28px sans-serif","black"),this.percentage.x=e.canvas.width/2-this.maxWidth/2+12,this.percentage.y=e.canvas.height/2-12,this.initialized=!0)},update:function(){var t=(e.assets.loaded+1)/e.assets.toLoad;this.frontBar.width=this.maxWidth*t,this.percentage.content=Math.floor(100*t)+"%"},remove:function(){e.remove(this.frontBar),e.remove(this.backBar),e.remove(this.percentage)}},e.particles=[],e.particleEffect=function(t,n,i,a,o,r,s,l,c,u,d,h,f,p,v,g,m,y){void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=function(){return e.circle(10,"red")}),void 0===a&&(a=10),void 0===o&&(o=0),void 0===r&&(r=!0),void 0===s&&(s=0),void 0===l&&(l=6.28),void 0===c&&(c=4),void 0===u&&(u=16),void 0===d&&(d=.1),void 0===h&&(h=1),void 0===f&&(f=.01),void 0===p&&(p=.05),void 0===v&&(v=.02),void 0===g&&(g=.02),void 0===m&&(m=.01),void 0===y&&(y=.03);for(var _,w=function(e,t){return e+Math.random()*(t-e)},x=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},b=[],C=(l-s)/(a-1),k=0;k<a;k++)r?(_=w(s,l),b.push(_)):(void 0===_&&(_=s),b.push(_),_+=C);b.forEach(function(a){!function(a){var r=i();r.frames.length>0&&r.gotoAndStop(x(0,r.frames.length-1)),r.x=t-r.halfWidth,r.y=n-r.halfHeight;var s=x(c,u);r.width=s,r.height=s,r.scaleSpeed=w(f,p),r.alphaSpeed=w(v,g),r.rotationSpeed=w(m,y);var l=w(d,h);r.vx=l*Math.cos(a),r.vy=l*Math.sin(a),r.updateParticle=function(){r.vy+=o,r.x+=r.vx,r.y+=r.vy,r.scaleX-r.scaleSpeed>0&&(r.scaleX-=r.scaleSpeed),r.scaleY-r.scaleSpeed>0&&(r.scaleY-=r.scaleSpeed),r.rotation+=r.rotationSpeed,r.alpha-=r.alphaSpeed,r.alpha<=0&&(e.remove(r),e.particles.splice(e.particles.indexOf(r),1))},e.particles.push(r)}(a)})},e.updateParticles=function(){if(e.particles.length>0)for(var t=e.particles.length-1;t>=0;t--)e.particles[t].updateParticle()},e.updateFunctions.push(e.updateParticles),e.emitter=function(e,t){function n(){i.playing||(t(),a=setInterval(function(){t()}.bind(this),e),i.playing=!0)}var i={},a=void 0;return i.playing=!1,i.play=n,i.stop=function(){i.playing&&(clearInterval(a),i.playing=!1)},i},e.tilingSprite=function(t,n,i,a,o){void 0===a&&(a=0),void 0===o&&(o=0);var r,s;e.assets[i].frame?(r=e.assets[i].frame.w,s=e.assets[i].frame.h):(r=e.assets[i].width,s=e.assets[i].height);var l,u;l=t>=r?Math.round(t/r)+1:2,u=n>=s?Math.round(n/s)+1:2;var d=e.grid(l,u,r,s,!1,0,0,function(){return e.sprite(i)});d._tileX=0,d._tileY=0;var h=e.rectangle(t,n,"none","none");return h.x=a,h.y=o,h.mask=!0,h.addChild(d),(0,c.default)(h,{tileX:{get:function(){return d._tileX},set:function(e){d.children.forEach(function(t){var n=e-d._tileX;t.x+=n,t.x>(l-1)*r&&(t.x=0-r+n),t.x<0-r-n&&(t.x=(l-1)*r)}),d._tileX=e},enumerable:!0,configurable:!0},tileY:{get:function(){return d._tileY},set:function(e){d.children.forEach(function(t){var n=e-d._tileY;t.y+=n,t.y>(u-1)*s&&(t.y=0-s+n),t.y<0-s-n&&(t.y=(u-1)*s)}),d._tileY=e},enumerable:!0,configurable:!0}}),h},e.outsideBounds=function(e,t,n){var i,a=t.x,o=t.y,r=t.width,s=t.height;return e.x<a-e.width&&(i="left"),e.y<o-e.height&&(i="top"),e.x>r&&(i="right"),e.y>s&&(i="bottom"),i&&n&&n(i),i},e.contain=function(e,t,n,i){var a=t.x,o=t.y,r=t.width,s=t.height;n=n||!1;var l;return e.x<a&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=a,l="left"),e.y<o&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=o,l="top"),e.x+e.width>r&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=r-e.width,l="right"),e.y+e.height>s&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=s-e.height,l="bottom"),l&&i&&i(l),l},e.hitTestPoint=function(e,t){var n,i,a,o,r,s,l,c;return"rectangle"==(n=t.radius?"circle":"rectangle")&&(i=t.x,a=t.x+t.width,o=t.y,r=t.y+t.height,c=e.x>i&&e.x<a&&e.y>o&&e.y<r),"circle"===n&&(s=e.x-t.centerX,l=e.y-t.centerY,c=Math.sqrt(s*s+l*l)<t.radius),c},e.hitTestCircle=function(e,t,n){var i,a,o,r;return void 0===n&&(n=!1),n?(i=t.gx+t.radius-(e.gx+e.radius),a=t.gy+t.radius-(e.gy+e.radius)):(i=t.centerX-e.centerX,a=t.centerY-e.centerY),o=Math.sqrt(i*i+a*a),r=e.radius+t.radius,o<r},e.hitTestRectangle=function(e,t,n){var i,a,o,r;return void 0===n&&(n=!1),n?(o=e.gx+e.halfWidth-(t.gx+t.halfWidth),r=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(o=e.centerX-t.centerX,r=e.centerY-t.centerY),i=e.halfWidth+t.halfWidth,a=e.halfHeight+t.halfHeight,Math.abs(o)<i&&Math.abs(r)<a},e.hitTestCircleRectangle=function(t,n,i){var a,o,r,s,l,c;if(void 0===i&&(i=!1),i?(r=t.gx,s=t.gy,l=n.gx,c=n.gy):(r=t.x,s=t.y,l=n.x,c=n.y),"topMiddle"==(a=s<c-n.halfHeight?r<l-1-n.halfWidth?"topLeft":r>l+1+n.halfWidth?"topRight":"topMiddle":s>c+n.halfHeight?r<l-1-n.halfWidth?"bottomLeft":r>l+1+n.halfWidth?"bottomRight":"bottomMiddle":r<l-n.halfWidth?"leftMiddle":"rightMiddle")||"bottomMiddle"===a||"leftMiddle"===a||"rightMiddle"===a)o=e.hitTestRectangle(t,n,i);else{var u={};switch(a){case"topLeft":u.x=l,u.y=c;break;case"topRight":u.x=l+n.width,u.y=c;break;case"bottomLeft":u.x=l,u.y=c+n.height;break;case"bottomRight":u.x=l+n.width,u.y=c+n.height}o=e.hitTestCirclePoint(t,u,i)}return o?a:o},e.hitTestCirclePoint=function(t,n,i){return void 0===i&&(i=!1),n.diameter=1,n.radius=.5,n.centerX=n.x,n.centerY=n.y,n.gx=n.x,n.gy=n.y,e.hitTestCircle(t,n,i)},e.rectangleCollision=function(e,t,n,i){var a,o,r,s,l,c,u;return void 0===n&&(n=!1),void 0===i&&(i=!1),i?(c=e.gx+e.halfWidth-(t.gx+t.halfWidth),u=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(c=e.centerX-t.centerX,u=e.centerY-t.centerY),o=e.halfWidth+t.halfWidth,r=e.halfHeight+t.halfHeight,Math.abs(c)<o&&Math.abs(u)<r&&((s=o-Math.abs(c))>=(l=r-Math.abs(u))?(u>0?(a="top",e.y=e.y+l):(a="bottom",e.y=e.y-l),n&&(e.vy*=-1)):(c>0?(a="left",e.x=e.x+s):(a="right",e.x=e.x-s),n&&(e.vx*=-1))),a},e.circleCollision=function(e,t,n,i){var a,o,r,s,l,c,u,d={},h=!1;return void 0===n&&(n=!0),void 0===i&&(i=!1),i?(s=t.gx+t.radius-(e.gx+e.radius),l=t.gy+t.radius-(e.gy+e.radius)):(s=t.centerX-e.centerX,l=t.centerY-e.centerY),a=Math.sqrt(s*s+l*l),o=e.radius+t.radius,a<o&&(h=!0,r=o-a,r+=.3,c=s/a,u=l/a,e.x-=r*c,e.y-=r*u,n&&(d.x=l,d.y=-s,function(e,t){var n,i,a={},o={},r={},s=e.mass||1;t.lx=t.y,t.ly=-t.x,t.magnitude=Math.sqrt(t.x*t.x+t.y*t.y),t.dx=t.x/t.magnitude,t.dy=t.y/t.magnitude,n=e.vx*t.dx+e.vy*t.dy,a.vx=n*t.dx,a.vy=n*t.dy,i=e.vx*(t.lx/t.magnitude)+e.vy*(t.ly/t.magnitude),o.vx=i*(t.lx/t.magnitude),o.vy=i*(t.ly/t.magnitude),o.vx*=-1,o.vy*=-1,r.x=a.vx+o.vx,r.y=a.vy+o.vy,e.vx=r.x/s,e.vy=r.y/s}(e,d))),h},e.movingCircleCollision=function(e,t,n){var i,a,o,r,s={},l={},c={},u={},d={},h=!1;if(e.mass=e.mass||1,t.mass=t.mass||1,void 0===n&&(n=!1),n?(s.vx=t.gx+t.radius-(e.gx+e.radius),s.vy=t.gy+t.radius-(e.gy+e.radius)):(s.vx=t.centerX-e.centerX,s.vy=t.centerY-e.centerY),s.magnitude=Math.sqrt(s.vx*s.vx+s.vy*s.vy),i=e.radius+t.radius,s.magnitude<i){h=!0,a=i-s.magnitude,a+=.3,s.dx=s.vx/s.magnitude,s.dy=s.vy/s.magnitude,s.vxHalf=Math.abs(s.dx*a/2),s.vyHalf=Math.abs(s.dy*a/2),o=e.x>t.x?1:-1,r=e.y>t.y?1:-1,e.x=e.x+s.vxHalf*o,e.y=e.y+s.vyHalf*r,t.x=t.x+s.vxHalf*-o,t.y=t.y+s.vyHalf*-r,s.lx=s.vy,s.ly=-s.vx;var f=e.vx*s.dx+e.vy*s.dy;l.x=f*s.dx,l.y=f*s.dy;var p=e.vx*(s.lx/s.magnitude)+e.vy*(s.ly/s.magnitude);c.x=p*(s.lx/s.magnitude),c.y=p*(s.ly/s.magnitude);var v=t.vx*s.dx+t.vy*s.dy;u.x=v*s.dx,u.y=v*s.dy;var g=t.vx*(s.lx/s.magnitude)+t.vy*(s.ly/s.magnitude);d.x=g*(s.lx/s.magnitude),d.y=g*(s.ly/s.magnitude),e.bounce={},e.bounce.x=c.x+u.x,e.bounce.y=c.y+u.y,t.bounce={},t.bounce.x=l.x+d.x,t.bounce.y=l.y+d.y,e.vx=e.bounce.x/e.mass,e.vy=e.bounce.y/e.mass,t.vx=t.bounce.x/t.mass,t.vy=t.bounce.y/t.mass}return h},e.multipleCircleCollision=function(t,n){void 0===n&&(n=!1);for(var i=0;i<t.length;i++)for(var a=t[i],o=i+1;o<t.length;o++){var r=t[o];e.movingCircleCollision(a,r,n)}},e.circlePointCollision=function(t,n,i,a){return void 0===a&&(a=!1),void 0===i&&(i=!1),n.diameter=1,n.radius=.5,n.centerX=n.x,n.centerY=n.y,n.gx=n.x,n.gy=n.y,e.circleCollision(t,n,i,a)},e.circleRectangleCollision=function(t,n,i,a){var o,r,s,l,c,u;if(void 0===a&&(a=!1),void 0===i&&(i=!1),a?(s=t.gx,l=t.gy,c=n.gx,u=n.gy):(s=t.x,l=t.y,c=n.x,u=n.y),"topMiddle"==(o=l<u-n.halfHeight?s<c-1-n.halfWidth?"topLeft":s>c+1+n.halfWidth?"topRight":"topMiddle":l>u+n.halfHeight?s<c-1-n.halfWidth?"bottomLeft":s>c+1+n.halfWidth?"bottomRight":"bottomMiddle":s<c-n.halfWidth?"leftMiddle":"rightMiddle")||"bottomMiddle"===o||"leftMiddle"===o||"rightMiddle"===o)r=e.rectangleCollision(t,n,i,a);else{var d={};switch(o){case"topLeft":d.x=c,d.y=u;break;case"topRight":d.x=c+n.width,d.y=u;break;case"bottomLeft":d.x=c,d.y=u+n.height;break;case"bottomRight":d.x=c+n.width,d.y=u+n.height}r=e.circlePointCollision(t,d,i,a)}return r?o:r},e.hit=function(t,n,i,a,o,r){function s(t,n){var r=void 0!==t.parent,s=void 0!==n.parent;if(r&&s)return t.diameter&&n.diameter?function(t,n){return i?t.vx+t.vy!==0&&n.vx+n.vy!==0?e.movingCircleCollision(t,n,o):e.circleCollision(t,n,a,o):e.hitTestCircle(t,n,o)}(t,n):t.diameter&&!n.diameter?function(t,n){return i?e.circleRectangleCollision(t,n,a,o):e.hitTestCircleRectangle(t,n,o)}(t,n):function(t,n){return i?a?e.rectangleCollision(t,n,!0,o):e.rectangleCollision(t,n,!1,o):e.hitTestRectangle(t,n,o)}(t,n);if(s&&void 0!==t.x&&void 0!==t.y)return e.hitTestPoint(t,n);throw new Error("I'm sorry, "+t+" and "+n+" cannot be use together in a collision test.")}var l;return i=i||!1,a=a||!1,o=o||!1,n instanceof Array||t instanceof Array?function(){t instanceof Array&&(n=t,t=t);for(var e=n.length-1;e>=0;e--){var i=n[e];(l=s(t,i))&&r&&r(l,i)}}():(l=s(t,n))&&r&&r(l),l},e.getIndex=function(e,t,n,i,a){var o={};return o.x=Math.floor(e/n),o.y=Math.floor(t/i),o.x+o.y*a},e.getTile=function(e,t,n){var i={};return i.gid=t[e],i.width=n.tilewidth,i.height=n.tileheight,i.halfWidth=n.tilewidth/2,i.halfHeight=n.tileheight/2,i.x=e%n.widthInTiles*n.tilewidth+n.x,i.y=Math.floor(e/n.widthInTiles)*n.tileheight+n.y,i.gx=i.x,i.gy=i.y,i.centerX=i.x+n.tilewidth/2,i.centery=i.y+n.tileheight/2,i},e.surroundingCells=function(e,t){return[e-t-1,e-t,e-t+1,e-1,e,e+1,e+t-1,e+t,e+t+1]},e.getPoints=function(e){var t=e.collisionArea;return void 0!==t?{topLeft:{x:e.x+t.x,y:e.y+t.y},topRight:{x:e.x+t.x+t.width,y:e.y+t.y},bottomLeft:{x:e.x+t.x,y:e.y+t.y+t.height},bottomRight:{x:e.x+t.x+t.width,y:e.y+t.y+t.height}}:{topLeft:{x:e.x,y:e.y},topRight:{x:e.x+e.width-1,y:e.y},bottomLeft:{x:e.x,y:e.y+e.height-1},bottomRight:{x:e.x+e.width-1,y:e.y+e.height-1}}},e.hitTestTile=function(t,n,i,a,o){function r(o){var r=t.collisionPoints[o];return l.index=e.getIndex(r.x,r.y,a.tilewidth,a.tileheight,a.widthInTiles),l.gid=n[l.index],l.gid===i}var l={};switch(o=o||"some"){case"center":var c={center:{x:t.centerX,y:t.centerY}};t.collisionPoints=c,l.hit=(0,s.default)(t.collisionPoints).some(r);break;case"every":t.collisionPoints=e.getPoints(t),l.hit=(0,s.default)(t.collisionPoints).every(r);break;case"some":t.collisionPoints=e.getPoints(t),l.hit=(0,s.default)(t.collisionPoints).some(r)}return l},e.updateMap=function(t,n,i){var a=t.map(function(e){return 0});if(n instanceof Array)n.forEach(function(t){t.index=e.getIndex(t.centerX,t.centerY,i.tilewidth,i.tileheight,i.widthInTiles),a[t.index]=t.gid});else{var o=n;o.index=e.getIndex(o.centerX,o.centerY,i.tilewidth,i.tileheight,i.widthInTiles),a[o.index]=o.gid}return a},e.fourKeyController=function(t,n,i,a,o,r){t.direction="",leftArrow=e.keyboard(r),upArrow=e.keyboard(i),rightArrow=e.keyboard(a),downArrow=e.keyboard(o),leftArrow.press=function(){t.vx=-n,t.vy=0,t.direction="left"},leftArrow.release=function(){rightArrow.isDown||0!==t.vy||(t.vx=0)},upArrow.press=function(){t.vy=-n,t.vx=0,t.direction="up"},upArrow.release=function(){downArrow.isDown||0!==t.vx||(t.vy=0)},rightArrow.press=function(){t.vx=n,t.vy=0,t.direction="right"},rightArrow.release=function(){leftArrow.isDown||0!==t.vy||(t.vx=0)},downArrow.press=function(){t.vy=n,t.vx=0,t.direction="down"},downArrow.release=function(){upArrow.isDown||0!==t.vx||(t.vy=0)}},e.makeTiledWorld=function(t,n){t=e.json(t);var i=e.group();i.tileheight=t.tileheight,i.tilewidth=t.tilewidth,i.width=t.width*t.tilewidth,i.height=t.height*t.tileheight,i.widthInTiles=t.width,i.heightInTiles=t.height,i.objects=[];var a=t.tilesets[0].spacing,o=Math.floor(t.tilesets[0].imagewidth/(t.tilewidth+a));return t.layers.forEach(function(r){var l=e.group();if((0,s.default)(r).forEach(function(e){"width"!==e&&"height"!==e&&(l[e]=r[e])}),l.alpha=r.opacity,i.addChild(l),i.objects.push(l),"tilelayer"===r.type)r.data.forEach(function(r,c){var u,d,h,f,p,v,g,m,y,_;if(0!==r){g=c%i.widthInTiles,m=Math.floor(c/i.widthInTiles),h=g*i.tilewidth,f=m*i.tileheight,y=(r-1)%o,_=Math.floor((r-1)/o),p=y*i.tilewidth,v=_*i.tileheight,a>0&&(p+=a+a*((r-1)%o),v+=a+a*Math.floor((r-1)/o)),d=e.frame(n,p,v,i.tilewidth,i.tileheight);var w=t.tilesets[0].tileproperties||{},x=String(r-1);w[x]&&w[x].name?(u=e.sprite(d),(0,s.default)(w[x]).forEach(function(e){u[e]=w[x][e]}),i.objects.push(u)):u=e.sprite(d),u.x=h,u.y=f,u.index=c,u.gid=r,l.addChild(u)}});else if("objectgroup"===r.type)l.width=i.width,l.height=i.height,r.objects.forEach(function(e){e.group=l,i.objects.push(e)});else if("imagelayer"===r.type){var c=e.sprite(r.image);l.addChild(c)}}),i.getObject=function(e){return this.searchForObject=function(){var t;return i.objects.some(function(n){if(n.name&&n.name===e)return t=n,!0}),t?t:void console.log("There is no object with the property name: "+e)},this.searchForObject()},i.getObjects=function(e){var t=Array.prototype.slice.call(arguments),n=[];return i.objects.forEach(function(e){e.name&&-1!==t.indexOf(e.name)&&n.push(e)}),n.length>0?n:(console.log("I could not find those objects"),n)},i},e.fullscreenScale=1,e.requestFullScreen=function(){document.fullscreenEnabled||e.canvas.requestFullscreen()},e.exitFullScreen=function(){document.fullscreenEnabled&&document.exitFullscreen()},e.alignFullscreen=function(){var t,n;if(t=screen.width/e.canvas.width,n=screen.height/e.canvas.height,e.fullscreenScale=Math.min(t,n),0===document.styleSheets.length){var i=document.createElement("div");i.innerHTML="<style></style>",document.body.appendChild(i)}var a=navigator.userAgent.toLowerCase();e.canvas.width>e.canvas.height?-1!==a.indexOf("safari")||-1!==a.indexOf("chrome")?document.styleSheets[0].insertRule("canvas:-webkit-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain}",0):-1!==a.indexOf("firefox")?document.styleSheets[0].insertRule("canvas:-moz-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==a.indexOf("opera")?document.styleSheets[0].insertRule("canvas:-o-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==a.indexOf("explorer")?document.styleSheets[0].insertRule("canvas:-ms-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):document.styleSheets[0].insertRule("canvas:fullscreen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==a.indexOf("safari")||-1!==a.indexOf("chrome")?document.styleSheets[0].insertRule("canvas:-webkit-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==a.indexOf("firefox")?document.styleSheets[0].insertRule("canvas:-moz-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==a.indexOf("opera")?document.styleSheets[0].insertRule("canvas:-o-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==a.indexOf("msie")?document.styleSheets[0].insertRule("canvas:-ms-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):document.styleSheets[0].insertRule("canvas:fullscreen {height: 100%; margin: 0 auto; object-fit: contain;}",0)},e.enableFullscreen=function(t){t&&(t=Array.prototype.slice.call(arguments)),e.alignFullscreen(),e.canvas.addEventListener("mouseup",e.requestFullScreen,!1),e.canvas.addEventListener("touchend",e.requestFullScreen,!1),t&&t.forEach(function(t){window.addEventListener("keyup",function(n){n.keyCode===t&&e.exitFullScreen(),n.preventDefault()},!1)})},e.launchFullscreen=function(t){e.hitTestPoint(e.pointer.position,t)&&e.enableFullscreen()},e.scaleFullscreen=function(){document.fullscreenEnabled?(e.scale=e.fullscreenScale,e.pointer.scale=e.fullscreenScale):e.canvas.scaled||(e.scale=1,e.pointer.scale=1)},e.updateFunctions.push(e.scaleFullscreen),e.actx=new AudioContext,e.makeSound=function(t,n){var i={},a=e.actx;return i.volumeNode=e.actx.createGain(),a.createStereoPanner?i.panNode=a.createStereoPanner():i.panNode=a.createPanner(),i.delayNode=a.createDelay(),i.feedbackNode=a.createGain(),i.filterNode=a.createBiquadFilter(),i.convolverNode=a.createConvolver(),i.soundNode=null,i.buffer=null,i.source=null,i.loop=!1,i.playing=!1,i.loadHandler=void 0,i.panValue=0,i.volumeValue=1,i.startTime=0,i.startOffset=0,i.playbackRate=1,i.echo=!1,i.delayValue=.3,i.feebackValue=.3,i.filterValue=0,i.reverb=!1,i.reverbImpulse=null,i.play=function(){i.startTime=a.currentTime,i.soundNode=a.createBufferSource(),i.soundNode.buffer=i.buffer,i.soundNode.playbackRate.value=this.playbackRate,i.soundNode.connect(i.volumeNode),!1===i.reverb?i.volumeNode.connect(i.panNode):(i.volumeNode.connect(i.convolverNode),i.convolverNode.connect(i.panNode),i.convolverNode.buffer=i.reverbImpulse),i.panNode.connect(a.destination),i.echo&&(i.feedbackNode.gain.value=i.feebackValue,i.delayNode.delayTime.value=i.delayValue,i.filterNode.frequency.value=i.filterValue,i.delayNode.connect(i.feedbackNode),i.filterValue>0?(i.feedbackNode.connect(i.filterNode),i.filterNode.connect(i.delayNode)):i.feedbackNode.connect(i.delayNode),i.volumeNode.connect(i.delayNode),i.delayNode.connect(i.panNode)),i.soundNode.loop=i.loop,i.soundNode.start(0,i.startOffset%i.buffer.duration),i.playing=!0},i.pause=function(){i.playing&&(i.soundNode.stop(0),i.startOffset+=a.currentTime-i.startTime,i.playing=!1)},i.restart=function(){i.playing&&i.soundNode.stop(0),i.startOffset=0,i.play()},i.playFrom=function(e){i.playing&&i.soundNode.stop(0),i.startOffset=e,i.play()},i.setEcho=function(e,t,n){void 0===e&&(e=.3),void 0===t&&(t=.3),void 0===n&&(n=0),i.delayValue=e,i.feebackValue=t,i.filterValue=n,i.echo=!0},i.setReverb=function(t,n,o){void 0===t&&(t=2),void 0===n&&(n=2),void 0===o&&(o=!1),i.reverbImpulse=e.impulseResponse(t,n,o,a),i.reverb=!0},i.fade=function(e,t){i.playing&&(i.volumeNode.gain.linearRampToValueAtTime(i.volumeNode.gain.value,a.currentTime),i.volumeNode.gain.linearRampToValueAtTime(e,a.currentTime+t))},i.fadeIn=function(e){i.volumeNode.gain.value=0,i.fade(1,e)},i.fadeOut=function(e){i.fade(0,e)},(0,c.default)(i,{volume:{get:function(){return i.volumeValue},set:function(e){i.volumeNode.gain.value=e,i.volumeValue=e},enumerable:!0,configurable:!0},pan:{get:function(){return a.createStereoPanner?i.panNode.pan.value:i.panValue},set:function(e){if(a.createStereoPanner)i.panNode.pan.value=e;else{var t=e,n=1-Math.abs(t);i.panNode.setPosition(t,0,n),i.panValue=e}},enumerable:!0,configurable:!0}}),i.load=function(){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.addEventListener("load",function(){a.decodeAudioData(e.response,function(e){i.buffer=e,i.hasLoaded=!0,n&&n()},function(e){throw new Error("Audio could not be decoded: "+e)})}),e.send()},i.load(),i},e.sound=function(t){return e.assets[t]},e.soundEffect=function(t,n,i,a,o,r,s,l,c,u,d,h,f){function p(t){var n=C.createConvolver();n.buffer=e.impulseResponse(f[0],f[1],f[2],C),t.connect(n),n.connect(b)}function v(e){var t=C.createGain(),n=C.createDelay(),i=C.createBiquadFilter();n.delayTime.value=h[0],t.gain.value=h[1],h[2]&&(i.frequency.value=h[2]),n.connect(t),h[2]?(t.connect(i),i.connect(n)):t.connect(n),e.connect(n),n.connect(b)}function g(e){e.gain.value=0,e.gain.linearRampToValueAtTime(0,C.currentTime+s),e.gain.linearRampToValueAtTime(o,C.currentTime+s+n)}function m(e){e.gain.linearRampToValueAtTime(o,C.currentTime+n+s),e.gain.linearRampToValueAtTime(0,C.currentTime+s+n+i)}function y(e){var t=e.frequency.value;c?(e.frequency.linearRampToValueAtTime(t,C.currentTime+s),e.frequency.linearRampToValueAtTime(t+l,C.currentTime+s+n+i)):(e.frequency.linearRampToValueAtTime(t,C.currentTime+s),e.frequency.linearRampToValueAtTime(t-l,C.currentTime+s+n+i))}function _(e){e.start(C.currentTime+s)}void 0===t&&(t=200),void 0===n&&(n=0),void 0===i&&(i=1),void 0===a&&(a="sine"),void 0===o&&(o=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=!1),void 0===u&&(u=0),void 0===d&&(d=0),void 0===h&&(h=void 0),void 0===f&&(f=void 0);var w,x,b,C=e.actx;w=C.createOscillator(),x=C.createGain(),b=C.createStereoPanner?C.createStereoPanner():C.createPanner(),w.connect(x),x.connect(b),b.connect(C.destination),x.gain.value=o,C.createStereoPanner?b.pan.value=r:b.setPosition(r,0,1-Math.abs(r)),w.type=a;var k;k=u>0?function(e,t){return Math.floor(Math.random()*(t-e+1))+e}(t-u/2,t+u/2):t,w.frequency.value=k,n>0&&g(x),m(x),l>0&&y(w),h&&v(x),f&&p(x),d>0&&function(){var e=C.createOscillator(),t=C.createOscillator(),a=C.createGain(),r=C.createGain();a.gain.value=o,r.gain.value=o,e.connect(a),a.connect(C.destination),t.connect(r),r.connect(C.destination),e.type="sawtooth",t.type="sawtooth",e.frequency.value=k+d,t.frequency.value=k-d,n>0&&(g(a),g(r)),i>0&&(m(a),m(r)),l>0&&(y(e),y(t)),h&&(v(a),v(r)),f&&(p(a),p(r)),_(e),_(t)}(),_(w)},e.impulseResponse=function(e,t,n,i){for(var a=i.sampleRate*e,o=i.createBuffer(2,a,i.sampleRate),r=o.getChannelData(0),s=o.getChannelData(1),l=0;l<a;l++){var c;c=n?a-l:l,r[l]=(2*Math.random()-1)*Math.pow(1-c/a,t),s[l]=(2*Math.random()-1)*Math.pow(1-c/a,t)}return o}}},296:function(e,t){},297:function(e,t){},298:function(e,t){},299:function(e,t){},300:function(e,t){},301:function(e,t){},302:function(e,t){},303:function(e,t){},304:function(e,t){},305:function(e,t){},306:function(e,t){},307:function(e,t){},418:function(e,t,n){function i(e){return n(a(e))}function a(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./af":106,"./af.js":106,"./ar":113,"./ar-dz":107,"./ar-dz.js":107,"./ar-kw":108,"./ar-kw.js":108,"./ar-ly":109,"./ar-ly.js":109,"./ar-ma":110,"./ar-ma.js":110,"./ar-sa":111,"./ar-sa.js":111,"./ar-tn":112,"./ar-tn.js":112,"./ar.js":113,"./az":114,"./az.js":114,"./be":115,"./be.js":115,"./bg":116,"./bg.js":116,"./bm":117,"./bm.js":117,"./bn":118,"./bn.js":118,"./bo":119,"./bo.js":119,"./br":120,"./br.js":120,"./bs":121,"./bs.js":121,"./ca":122,"./ca.js":122,"./cs":123,"./cs.js":123,"./cv":124,"./cv.js":124,"./cy":125,"./cy.js":125,"./da":126,"./da.js":126,"./de":129,"./de-at":127,"./de-at.js":127,"./de-ch":128,"./de-ch.js":128,"./de.js":129,"./dv":130,"./dv.js":130,"./el":131,"./el.js":131,"./en-au":132,"./en-au.js":132,"./en-ca":133,"./en-ca.js":133,"./en-gb":134,"./en-gb.js":134,"./en-ie":135,"./en-ie.js":135,"./en-nz":136,"./en-nz.js":136,"./eo":137,"./eo.js":137,"./es":140,"./es-do":138,"./es-do.js":138,"./es-us":139,"./es-us.js":139,"./es.js":140,"./et":141,"./et.js":141,"./eu":142,"./eu.js":142,"./fa":143,"./fa.js":143,"./fi":144,"./fi.js":144,"./fo":145,"./fo.js":145,"./fr":148,"./fr-ca":146,"./fr-ca.js":146,"./fr-ch":147,"./fr-ch.js":147,"./fr.js":148,"./fy":149,"./fy.js":149,"./gd":150,"./gd.js":150,"./gl":151,"./gl.js":151,"./gom-latn":152,"./gom-latn.js":152,"./gu":153,"./gu.js":153,"./he":154,"./he.js":154,"./hi":155,"./hi.js":155,"./hr":156,"./hr.js":156,"./hu":157,"./hu.js":157,"./hy-am":158,"./hy-am.js":158,"./id":159,"./id.js":159,"./is":160,"./is.js":160,"./it":161,"./it.js":161,"./ja":162,"./ja.js":162,"./jv":163,"./jv.js":163,"./ka":164,"./ka.js":164,"./kk":165,"./kk.js":165,"./km":166,"./km.js":166,"./kn":167,"./kn.js":167,"./ko":168,"./ko.js":168,"./ky":169,"./ky.js":169,"./lb":170,"./lb.js":170,"./lo":171,"./lo.js":171,"./lt":172,"./lt.js":172,"./lv":173,"./lv.js":173,"./me":174,"./me.js":174,"./mi":175,"./mi.js":175,"./mk":176,"./mk.js":176,"./ml":177,"./ml.js":177,"./mr":178,"./mr.js":178,"./ms":180,"./ms-my":179,"./ms-my.js":179,"./ms.js":180,"./my":181,"./my.js":181,"./nb":182,"./nb.js":182,"./ne":183,"./ne.js":183,"./nl":185,"./nl-be":184,"./nl-be.js":184,"./nl.js":185,"./nn":186,"./nn.js":186,"./pa-in":187,"./pa-in.js":187,"./pl":188,"./pl.js":188,"./pt":190,"./pt-br":189,"./pt-br.js":189,"./pt.js":190,"./ro":191,"./ro.js":191,"./ru":192,"./ru.js":192,"./sd":193,"./sd.js":193,"./se":194,"./se.js":194,"./si":195,"./si.js":195,"./sk":196,"./sk.js":196,"./sl":197,"./sl.js":197,"./sq":198,"./sq.js":198,"./sr":200,"./sr-cyrl":199,"./sr-cyrl.js":199,"./sr.js":200,"./ss":201,"./ss.js":201,"./sv":202,"./sv.js":202,"./sw":203,"./sw.js":203,"./ta":204,"./ta.js":204,"./te":205,"./te.js":205,"./tet":206,"./tet.js":206,"./th":207,"./th.js":207,"./tl-ph":208,"./tl-ph.js":208,"./tlh":209,"./tlh.js":209,"./tr":210,"./tr.js":210,"./tzl":211,"./tzl.js":211,"./tzm":213,"./tzm-latn":212,"./tzm-latn.js":212,"./tzm.js":213,"./uk":214,"./uk.js":214,"./ur":215,"./ur.js":215,"./uz":217,"./uz-latn":216,"./uz-latn.js":216,"./uz.js":217,"./vi":218,"./vi.js":218,"./x-pseudo":219,"./x-pseudo.js":219,"./yo":220,"./yo.js":220,"./zh-cn":221,"./zh-cn.js":221,"./zh-hk":222,"./zh-hk.js":222,"./zh-tw":223,"./zh-tw.js":223};i.keys=function(){return Object.keys(o)},i.resolve=a,e.exports=i,i.id=418},429:function(e,t,n){n(298);var i=n(6)(n(231),n(441),null,null);e.exports=i.exports},430:function(e,t,n){n(303);var i=n(6)(n(232),n(446),"data-v-a478d95e",null);e.exports=i.exports},431:function(e,t,n){n(307);var i=n(6)(n(233),n(450),"data-v-c4b729c6",null);e.exports=i.exports},432:function(e,t,n){n(301);var i=n(6)(n(234),n(444),"data-v-66565f43",null);e.exports=i.exports},433:function(e,t,n){n(300);var i=n(6)(n(235),n(443),"data-v-42f77292",null);e.exports=i.exports},434:function(e,t,n){n(302);var i=n(6)(n(236),n(445),"data-v-7fbafc8f",null);e.exports=i.exports},435:function(e,t,n){n(297);var i=n(6)(n(237),n(440),"data-v-0c184361",null);e.exports=i.exports},436:function(e,t,n){n(299);var i=n(6)(n(238),n(442),"data-v-18e48a86",null);e.exports=i.exports},437:function(e,t,n){n(305);var i=n(6)(n(239),n(448),"data-v-b160fe6a",null);e.exports=i.exports},438:function(e,t,n){n(306);var i=n(6)(n(240),n(449),"data-v-bcbd114e",null);e.exports=i.exports},439:function(e,t,n){n(304);var i=n(6)(n(241),n(447),"data-v-b106f918",null);e.exports=i.exports},440:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("goods",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v("商品管理")])]),e._v(" "),n("button",{staticClass:"btn pull-right icon icon-add",on:{touchend:function(t){e.newItem=!0}}})]),e._v(" "),n("div",{staticClass:"content"},[e.newItem?n("div",{staticClass:"padded-list"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_title,expression:"new_title"}],attrs:{type:"text",placeholder:"名称"},domProps:{value:e.new_title},on:{input:function(t){t.target.composing||(e.new_title=t.target.value)}}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.new_comments,expression:"new_comments"
}],attrs:{placeholder:"商品描述"},domProps:{value:e.new_comments},on:{input:function(t){t.target.composing||(e.new_comments=t.target.value)}}}),e._v(" "),n("img",{attrs:{id:"new_img",src:e.new_img}}),e._v(" "),n("input",{attrs:{type:"file"},on:{change:function(t){e.processFile(t)}}}),e._v(" "),n("div",{staticClass:"input-wrapper"},[n("div",[e._v("售价:")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_price,expression:"new_price"}],attrs:{type:"number"},domProps:{value:e.new_price},on:{input:function(t){t.target.composing||(e.new_price=t.target.value)}}}),e._v(" "),n("div",[e._v("（元）")])]),e._v(" "),n("button",{staticClass:"btn fit-parent",on:{touchend:function(t){e.open_img()}}},[e._v("添加图片")]),e._v(" "),n("button",{staticClass:"btn fit-parent primary",on:{touchend:function(t){e.addGoods()}}},[e._v("添加商品")]),e._v(" "),n("button",{staticClass:"btn fit-parent negative",on:{touchend:function(t){e.newItem=!1}}},[e._v("取消")])]):e._e(),e._v(" "),n("ul",{staticClass:"list"},e._l(e.goods,function(t){return n("li",[n("div",{staticClass:"padded-list"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"g.title"}],attrs:{type:"text",placeholder:"名称"},domProps:{value:t.title},on:{input:function(n){n.target.composing||e.$set(t,"title",n.target.value)}}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comments,expression:"g.comments"}],attrs:{placeholder:"商品描述"},domProps:{value:t.comments},on:{input:function(n){n.target.composing||e.$set(t,"comments",n.target.value)}}}),e._v(" "),n("img",{attrs:{src:t.img}}),e._v(" "),n("div",{staticClass:"input-wrapper"},[n("div",[e._v("售价:")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"g.price"}],attrs:{type:"number",onclick:"this.select()"},domProps:{value:t.price},on:{input:function(n){n.target.composing||e.$set(t,"price",n.target.value)}}}),e._v(" "),n("div",[e._v("（元）")])]),e._v(" "),n("button",{staticClass:"btn fit-parent primary",on:{touchend:function(n){e.saveGoods(t)}}},[e._v("保存")]),e._v(" "),n("button",{staticClass:"btn fit-parent negative",on:{touchend:function(n){e.delete_item(t)}}},[e._v("删除")])])])}))])])},staticRenderFns:[]}},441:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("game",{attrs:{app:e.app}}),e._v(" "),n("help",{attrs:{app:e.app}}),e._v(" "),n("gestures",{attrs:{app:e.app}}),e._v(" "),n("design",{attrs:{app:e.app}}),e._v(" "),n("goods",{attrs:{app:e.app}}),e._v(" "),n("buy",{attrs:{app:e.app}}),e._v(" "),n("chat",{attrs:{app:e.app}}),e._v(" "),n("profile",{attrs:{app:e.app}}),e._v(" "),n("noty",{attrs:{app:e.app}}),e._v(" "),n("order",{attrs:{app:e.app}})],1)},staticRenderFns:[]}},442:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("help",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("div",{staticClass:"left"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("h1",{staticClass:"title"},[e._v("使用说明")])])]),e._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"padded-full"},[n("h2",[e._v("操作")]),e._v(" "),n("p",[e._v("大部分操作都在主屏幕（也就是游戏界面）上，以划动手势完成。\n        下面说的划哪个字母，只是跟那个字母"),n("i",[e._v("近似的手势")]),e._v("，每个人书写的习惯不同可能会有误差。\n        可以打开手势管理界面自定义习惯的手势操作。")]),e._v(" "),n("h3",[e._v("人物移动")]),e._v(" "),n("p",[e._v("用手指在屏幕上滑动即可控制角色移动，移动的方向与滑动方向一致。点击自身停止移动")]),e._v(" "),n("h3",[e._v("选择玩家")]),e._v(" "),n("p",[e._v("点击玩家角色以选择玩家，被选中的玩家头像会出现在屏幕上方。然后点击玩家头像则会显示玩家信息")]),e._v(" "),n("h3",[e._v("聊天")]),e._v(" "),n("p",[e._v("在屏幕上划个c（for chat, 默认手势）打开聊天界面。如果当前已选中玩家则对玩家私聊，否则就对所有玩家广播")]),e._v(" "),n("h3",[e._v("售卖")]),e._v(" "),n("p",[e._v("在屏幕上划个p（for product, 默认手势）打开商品管理界面。在此可以添加商品名称、描述、图片、价格。\n        玩家的付款先打入智慧旅游账户，买方确认收货后，卖方5个工作日内会收到微信红包，包含售卖的金额（扣除千分之6手续费）。\n        如果买家选择开电子发票，还需额外扣除千分之1费用。")]),e._v(" "),n("h3",[e._v("购买")]),e._v(" "),n("p",[e._v("有商品销售的玩家头上会有个“卖”字，点击选中此玩家后，划b（for buy，默认手势），打开该玩家的产品页面")]),e._v(" "),n("h3",[e._v("订单")]),e._v(" "),n("p",[e._v("在屏幕上划个o（for order, 默认手势）打开订单界面。在此可以查看售卖的订单记录")]),e._v(" "),n("h3",[e._v("系统通知")]),e._v(" "),n("p",[e._v("在屏幕上划个n（for notification, 默认手势）打开系统通知界面。在此可以查看系统通知记录，比如买家支付成功、已发货、已确认收货等")]),e._v(" "),n("h3",[e._v("手势设置")]),e._v(" "),n("p",[e._v("在屏幕上划个g（for gestures, 默认手势）打开手势设置界面。在此可以更改默认手势。编辑手势时需一笔划完，中途不可抬起手指，可以是任意字母、符号、汉字……")]),e._v(" "),n("h3",[e._v("帮助")]),e._v(" "),n("p",[e._v("在屏幕上划个h（for help, 默认手势）打开此帮助界面。在此界面点以下按钮可以跳转到其它各功能界面")]),e._v(" "),n("button",{staticClass:"btn fit-parent padded-bottom primary"}),e._v(" "),n("button",{staticClass:"btn fit-parent padded-bottom",attrs:{"data-navigation":"gestures"}},[e._v("手势设置")]),e._v(" "),n("button",{staticClass:"btn fit-parent padded-bottom",attrs:{"data-navigation":"chat"}},[e._v("聊天记录")]),e._v(" "),n("button",{staticClass:"btn fit-parent padded-bottom",attrs:{"data-navigation":"goods"}},[e._v("商品管理")]),e._v(" "),n("button",{staticClass:"btn fit-parent padded-bottom",attrs:{"data-navigation":"order"}},[e._v("订单查询")]),e._v(" "),n("button",{staticClass:"btn fit-parent padded-bottom",attrs:{"data-navigation":"noty"}},[e._v("系统通知")])])])])},staticRenderFns:[]}},443:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("game",{attrs:{id:"game_main","data-page":"true"}},[n("div",{staticClass:"header"},[e.show_head_panel?n("img",{attrs:{src:e.headimgurl},on:{touchend:e.show_profile}}):e._e(),e._v(" "),e.show_head_panel?n("div",{staticClass:"title"},[e._v(e._s(e.wi.nickname))]):e._e(),e._v(" "),e.show_head_panel&&e.wi.seller?n("div",{staticClass:"title"},[e._v("(商人)")]):e._e(),e._v(" "),e.show_head_panel?n("i",{staticClass:"icon icon-close with-circle",on:{touchend:e.clear_target}}):e._e(),e._v(" "),n("button",{staticClass:"btn icon icon-info-outline with-circle help",attrs:{"data-navigation":"help"}})]),e._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"recognize-area"},[n("canvas")])]),e._v(" "),n("div",{staticClass:"footer"},[n("div",[e._v("坐标:"+e._s("("+e.cur_x+", "+e.cur_y+")"))]),e._v(" "),e.info?n("div",{staticClass:"debug"},[e._v("info:"+e._s(e.info))]):e._e(),e._v(" "),n("div",{staticClass:"count"},[e._v("在线人数："+e._s(e.online_count)+"人")])])])},staticRenderFns:[]}},444:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("design",{attrs:{id:"design","data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("div",{staticClass:"left"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("h1",{staticClass:"title"},[e._v("设置手势")])])]),e._v(" "),n("div",{staticClass:"content"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.strokeName,expression:"strokeName"}],attrs:{type:"text",placeholder:"名称",readonly:!e.$isDev},domProps:{value:e.strokeName},on:{input:function(t){t.target.composing||(e.strokeName=t.target.value)}}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comments,expression:"comments"}],attrs:{placeholder:"功能说明文字",readonly:!e.$isDev},domProps:{value:e.comments},on:{input:function(t){t.target.composing||(e.comments=t.target.value)}}}),e._v(" "),n("div",{staticClass:"recognize-area"},[n("canvas")]),e._v(" "),n("button",{staticClass:"btn primary",on:{touchend:e.onSave}},[e._v("保存")])])])},staticRenderFns:[]}},445:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("gestures",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v("手势绑定")])]),e._v(" "),e.$isDev?n("button",{staticClass:"btn pull-right icon icon-add",attrs:{"data-navigation":"design"}}):e._e(),e._v(" "),e.$isDev?n("button",{staticClass:"btn pull-right icon icon-sync with-circle",on:{touchend:function(t){e.save_gestures()}}}):e._e(),e._v(" "),n("button",{staticClass:"btn pull-right",on:{touchend:function(t){e.get_default_gestures()}}},[e._v("恢复默认")])]),e._v(" "),n("div",{staticClass:"content"},[n("ul",{staticClass:"list"},e._l(e.strokes,function(t){return n("li",[n("a",{staticClass:"padded-list"},[n("canvas",{attrs:{id:t.Name,width:"250",height:"250"}}),e._v(" "),n("div",[n("h3",{staticClass:"fit-parent"},[e._v(e._s(t.Name))]),e._v(" "),n("h4",{staticClass:"comments"},[e._v(e._s(t.Comments))]),e._v(" "),n("button",{staticClass:"btn fit-parent primary",on:{touchend:function(n){e.goDesign(t.Name)}}},[e._v("编辑")]),e._v(" "),e.$isDev?n("button",{staticClass:"btn fit-parent negative",on:{touchend:function(n){e.delete_stroke(t.Name)}}},[e._v("删除")]):e._e()])])])}))])])},staticRenderFns:[]}},446:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("buy",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v(e._s(e.seller.nickname)+"的商品")])]),e._v(" "),n("button",{staticClass:"btn pull-right icon icon-add",on:{touchend:function(t){e.newItem=!0}}})]),e._v(" "),n("div",{staticClass:"content"},[n("ul",{staticClass:"list"},e._l(e.goods,function(t){return n("li",[n("div",{staticClass:"padded-list"},[n("div",[n("h2",[e._v(e._s(t.title))])]),e._v(" "),n("p",[e._v(e._s(t.comments))]),e._v(" "),n("img",{attrs:{src:t.img}}),e._v(" "),n("div",[n("h3",[e._v("售价："+e._s(t.price)+"（元）")])]),e._v(" "),n("div",{staticClass:"input-wrapper"},[n("div",[e._v("购买数量：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.count,expression:"g.count"}],attrs:{type:"number",onclick:"this.select()"},domProps:{value:t.count},on:{input:function(n){n.target.composing||e.$set(t,"count",n.target.value)}}})])])])})),e._v(" "),n("button",{staticClass:"btn fit-parent primary",on:{touchend:function(t){e.buy()}}},[e._v("购买")])])])},staticRenderFns:[]}},447:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("profile",{attrs:{id:"profile","data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("div",{staticClass:"left"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}})]),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v("玩家信息")])])]),e._v(" "),n("div",{staticClass:"content"},[n("img",{staticClass:"hiu",attrs:{src:e.headimgurl}}),e._v(" "),n("ul",{staticClass:"list"},[n("li",[n("div",{staticClass:"pull-right"},[e._v("昵称")]),e._v(" "),n("span",{staticClass:"padded-list"},[e._v(e._s(e.player.nickname))])]),e._v(" "),n("li",[n("div",{staticClass:"pull-right"},[e._v("性别")]),e._v(" "),n("span",{staticClass:"padded-list"},[e._v(e._s(e.player.sex))])]),e._v(" "),n("li",[n("div",{staticClass:"pull-right"},[e._v("语言")]),e._v(" "),n("span",{staticClass:"padded-list"},[e._v(e._s(e.player.language))])]),e._v(" "),n("li",[n("div",{staticClass:"pull-right"},[e._v("城市")]),e._v(" "),n("span",{staticClass:"padded-list"},[e._v(e._s(e.player.city))])]),e._v(" "),n("li",[n("div",{staticClass:"pull-right"},[e._v("省份")]),e._v(" "),n("span",{staticClass:"padded-list"},[e._v(e._s(e.player.province))])]),e._v(" "),n("li",[n("div",{staticClass:"pull-right"},[e._v("国家")]),e._v(" "),n("span",{staticClass:"padded-list"},[e._v(e._s(e.player.country))])])])])])},staticRenderFns:[]}},448:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("noty",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v("系统消息")])])]),e._v(" "),n("div",{staticClass:"content"},[n("ul",{staticClass:"list"},e._l(e.msgs,function(t){return n("li",[n("div",{staticClass:"padded-list"},[n("div",[n("h3",[e._v(e._s(t.dt))])]),e._v(" "),n("p",[e._v(e._s(t.content))])])])}))])])},staticRenderFns:[]}},449:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("order",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v("订单列表")])])]),e._v(" "),n("div",{staticClass:"content"},[n("ul",{staticClass:"list"},e._l(e.orders,function(t){return n("li",[n("div",{staticClass:"order_info"},[n("div",{staticClass:"order_item"},[n("div",[e._v("买家：")]),n("div",{staticClass:"info"},[e._v(e._s(t.buyer_nickname))])]),e._v(" "),n("div",{staticClass:"order_item"},[n("div",[e._v("卖家：")]),n("div",{staticClass:"info"},[e._v(e._s(t.seller_nickname))])]),e._v(" "),n("div",{staticClass:"order_item"},[n("div",[e._v("交易时间：")]),n("div",{staticClass:"info"},[e._v(e._s(t.dt))])]),e._v(" "),n("div",{staticClass:"order_item"},[n("div",[e._v("商品名称：")]),n("div",{staticClass:"info"},[e._v(e._s(t.title))])]),e._v(" "),n("div",{staticClass:"order_item"},[n("div",[e._v("总价：")]),n("div",{staticClass:"info"},[e._v(e._s(t.total))])]),e._v(" "),n("div",{staticClass:"order_item"},[n("div",[e._v("状态：")]),n("div",{staticClass:"info"},[e._v(e._s(t.status))])]),e._v(" "),e.get_caption(t)?n("button",{staticClass:"btn fit-parent positive",on:{touchend:function(n){e.do_action(t)}}},[e._v(e._s(e.get_caption(t)))]):e._e()])])}))])])},staticRenderFns:[]}},450:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chat",{attrs:{"data-page":"true"}},[n("header",{staticClass:"header-bar"},[n("button",{staticClass:"btn pull-left icon icon-arrow-back",attrs:{"data-navigation":"$previous-page"}}),e._v(" "),n("div",{staticClass:"center"},[n("h1",{staticClass:"title"},[e._v("聊天记录")])]),e._v(" "),n("button",{staticClass:"btn pull-right ",on:{touchend:function(t){e.clear()}}},[e._v("清空")])]),e._v(" "),n("div",{staticClass:"content"},[n("ul",{staticClass:"list"},e._l(e.chat_log,function(t){return n("li",[n("div",{staticClass:"padded-list"},[n("div",[n("img",{attrs:{src:e.headimgurl(t.headimgurl)}}),n("div",{staticClass:"caption"},[e._v(e._s(t.dt)+" "+e._s(t.from)+"对"),n("i",{staticClass:"target"},[e._v(e._s(t.to))]),e._v("说：")])]),e._v(" "),n("div",[n("div",[e._v(e._s(t.content))]),e._v(" "),t.img?n("img",{attrs:{src:t.img}}):e._e()])])])})),e._v(" "),n("div",{staticClass:"input-wrapper"},[n("div",{staticClass:"prompt"},[e._v("对"),n("i",{staticClass:"target"},[e._v(e._s(e.target))]),e._v("说：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],attrs:{placeholder:"聊天内容"},domProps:{value:e.content},on:{input:function(t){t.target.composing||(e.content=t.target.value)}}}),e._v(" "),n("input",{attrs:{type:"file"},on:{change:function(t){e.processFile(t)}}}),e._v(" "),n("i",{staticClass:"icon icon-add with-circle",on:{touchend:e.open_img}}),e._v(" "),n("button",{staticClass:"btn primary",on:{touchend:e.send}},[e._v("发送")])])])])},staticRenderFns:[]}},451:function(e,t){}});
//# sourceMappingURL=app.bee8e46e37802bc06909.js.map